{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/objectSpread\";\nimport _typeof from \"@babel/runtime/helpers/typeof\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport baseLogger from './logger.js';\nimport EventEmitter from './EventEmitter.js';\nimport postProcessor from './postProcessor.js';\nimport * as utils from './utils.js';\n\nvar Translator = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(Translator, _EventEmitter);\n\n  function Translator(services) {\n    var _this;\n\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Translator);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Translator).call(this));\n    EventEmitter.call(_assertThisInitialized(_assertThisInitialized(_this))); // <=IE10 fix (unable to call parent constructor)\n\n    utils.copy(['resourceStore', 'languageUtils', 'pluralResolver', 'interpolator', 'backendConnector', 'i18nFormat'], services, _assertThisInitialized(_assertThisInitialized(_this)));\n    _this.options = options;\n\n    if (_this.options.keySeparator === undefined) {\n      _this.options.keySeparator = '.';\n    }\n\n    _this.logger = baseLogger.create('translator');\n    return _this;\n  }\n\n  _createClass(Translator, [{\n    key: \"changeLanguage\",\n    value: function changeLanguage(lng) {\n      if (lng) this.language = lng;\n    }\n  }, {\n    key: \"exists\",\n    value: function exists(key) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n        interpolation: {}\n      };\n      var resolved = this.resolve(key, options);\n      return resolved && resolved.res !== undefined;\n    }\n  }, {\n    key: \"extractFromKey\",\n    value: function extractFromKey(key, options) {\n      var nsSeparator = options.nsSeparator || this.options.nsSeparator;\n      if (nsSeparator === undefined) nsSeparator = ':';\n      var keySeparator = options.keySeparator !== undefined ? options.keySeparator : this.options.keySeparator;\n      var namespaces = options.ns || this.options.defaultNS;\n\n      if (nsSeparator && key.indexOf(nsSeparator) > -1) {\n        var parts = key.split(nsSeparator);\n        if (nsSeparator !== keySeparator || nsSeparator === keySeparator && this.options.ns.indexOf(parts[0]) > -1) namespaces = parts.shift();\n        key = parts.join(keySeparator);\n      }\n\n      if (typeof namespaces === 'string') namespaces = [namespaces];\n      return {\n        key: key,\n        namespaces: namespaces\n      };\n    }\n  }, {\n    key: \"translate\",\n    value: function translate(keys, options) {\n      var _this2 = this;\n\n      if (_typeof(options) !== 'object' && this.options.overloadTranslationOptionHandler) {\n        /* eslint prefer-rest-params: 0 */\n        options = this.options.overloadTranslationOptionHandler(arguments);\n      }\n\n      if (!options) options = {}; // non valid keys handling\n\n      if (keys === undefined || keys === null) return '';\n      if (!Array.isArray(keys)) keys = [String(keys)]; // separators\n\n      var keySeparator = options.keySeparator !== undefined ? options.keySeparator : this.options.keySeparator; // get namespace(s)\n\n      var _this$extractFromKey = this.extractFromKey(keys[keys.length - 1], options),\n          key = _this$extractFromKey.key,\n          namespaces = _this$extractFromKey.namespaces;\n\n      var namespace = namespaces[namespaces.length - 1]; // return key on CIMode\n\n      var lng = options.lng || this.language;\n      var appendNamespaceToCIMode = options.appendNamespaceToCIMode || this.options.appendNamespaceToCIMode;\n\n      if (lng && lng.toLowerCase() === 'cimode') {\n        if (appendNamespaceToCIMode) {\n          var nsSeparator = options.nsSeparator || this.options.nsSeparator;\n          return namespace + nsSeparator + key;\n        }\n\n        return key;\n      } // resolve from store\n\n\n      var resolved = this.resolve(keys, options);\n      var res = resolved && resolved.res;\n      var resUsedKey = resolved && resolved.usedKey || key;\n      var resExactUsedKey = resolved && resolved.exactUsedKey || key;\n      var resType = Object.prototype.toString.apply(res);\n      var noObject = ['[object Number]', '[object Function]', '[object RegExp]'];\n      var joinArrays = options.joinArrays !== undefined ? options.joinArrays : this.options.joinArrays; // object\n\n      var handleAsObjectInI18nFormat = !this.i18nFormat || this.i18nFormat.handleAsObject;\n      var handleAsObject = typeof res !== 'string' && typeof res !== 'boolean' && typeof res !== 'number';\n\n      if (handleAsObjectInI18nFormat && res && handleAsObject && noObject.indexOf(resType) < 0 && !(typeof joinArrays === 'string' && resType === '[object Array]')) {\n        if (!options.returnObjects && !this.options.returnObjects) {\n          this.logger.warn('accessing an object - but returnObjects options is not enabled!');\n          return this.options.returnedObjectHandler ? this.options.returnedObjectHandler(resUsedKey, res, options) : \"key '\".concat(key, \" (\").concat(this.language, \")' returned an object instead of string.\");\n        } // if we got a separator we loop over children - else we just return object as is\n        // as having it set to false means no hierarchy so no lookup for nested values\n\n\n        if (keySeparator) {\n          var resTypeIsArray = resType === '[object Array]';\n          var copy = resTypeIsArray ? [] : {}; // apply child translation on a copy\n\n          /* eslint no-restricted-syntax: 0 */\n\n          var newKeyToUse = resTypeIsArray ? resExactUsedKey : resUsedKey;\n\n          for (var m in res) {\n            if (Object.prototype.hasOwnProperty.call(res, m)) {\n              var deepKey = \"\".concat(newKeyToUse).concat(keySeparator).concat(m);\n              copy[m] = this.translate(deepKey, _objectSpread({}, options, {\n                joinArrays: false,\n                ns: namespaces\n              }));\n              if (copy[m] === deepKey) copy[m] = res[m]; // if nothing found use orginal value as fallback\n            }\n          }\n\n          res = copy;\n        }\n      } else if (handleAsObjectInI18nFormat && typeof joinArrays === 'string' && resType === '[object Array]') {\n        // array special treatment\n        res = res.join(joinArrays);\n        if (res) res = this.extendTranslation(res, keys, options);\n      } else {\n        // string, empty or null\n        var usedDefault = false;\n        var usedKey = false; // fallback value\n\n        if (!this.isValidLookup(res) && options.defaultValue !== undefined) {\n          usedDefault = true;\n\n          if (options.count !== undefined) {\n            var suffix = this.pluralResolver.getSuffix(lng, options.count);\n            res = options[\"defaultValue\".concat(suffix)];\n          }\n\n          if (!res) res = options.defaultValue;\n        }\n\n        if (!this.isValidLookup(res)) {\n          usedKey = true;\n          res = key;\n        } // save missing\n\n\n        var updateMissing = options.defaultValue && options.defaultValue !== res && this.options.updateMissing;\n\n        if (usedKey || usedDefault || updateMissing) {\n          this.logger.log(updateMissing ? 'updateKey' : 'missingKey', lng, namespace, key, updateMissing ? options.defaultValue : res);\n          var lngs = [];\n          var fallbackLngs = this.languageUtils.getFallbackCodes(this.options.fallbackLng, options.lng || this.language);\n\n          if (this.options.saveMissingTo === 'fallback' && fallbackLngs && fallbackLngs[0]) {\n            for (var i = 0; i < fallbackLngs.length; i++) {\n              lngs.push(fallbackLngs[i]);\n            }\n          } else if (this.options.saveMissingTo === 'all') {\n            lngs = this.languageUtils.toResolveHierarchy(options.lng || this.language);\n          } else {\n            lngs.push(options.lng || this.language);\n          }\n\n          var send = function send(l, k) {\n            if (_this2.options.missingKeyHandler) {\n              _this2.options.missingKeyHandler(l, namespace, k, updateMissing ? options.defaultValue : res, updateMissing, options);\n            } else if (_this2.backendConnector && _this2.backendConnector.saveMissing) {\n              _this2.backendConnector.saveMissing(l, namespace, k, updateMissing ? options.defaultValue : res, updateMissing, options);\n            }\n\n            _this2.emit('missingKey', l, namespace, k, res);\n          };\n\n          if (this.options.saveMissing) {\n            var needsPluralHandling = options.count !== undefined && typeof options.count !== 'string';\n\n            if (this.options.saveMissingPlurals && needsPluralHandling) {\n              lngs.forEach(function (l) {\n                var plurals = _this2.pluralResolver.getPluralFormsOfKey(l, key);\n\n                plurals.forEach(function (p) {\n                  return send([l], p);\n                });\n              });\n            } else {\n              send(lngs, key);\n            }\n          }\n        } // extend\n\n\n        res = this.extendTranslation(res, keys, options, resolved); // append namespace if still key\n\n        if (usedKey && res === key && this.options.appendNamespaceToMissingKey) res = \"\".concat(namespace, \":\").concat(key); // parseMissingKeyHandler\n\n        if (usedKey && this.options.parseMissingKeyHandler) res = this.options.parseMissingKeyHandler(res);\n      } // return\n\n\n      return res;\n    }\n  }, {\n    key: \"extendTranslation\",\n    value: function extendTranslation(res, key, options, resolved) {\n      var _this3 = this;\n\n      if (this.i18nFormat && this.i18nFormat.parse) {\n        res = this.i18nFormat.parse(res, options, resolved.usedLng, resolved.usedNS, resolved.usedKey, {\n          resolved: resolved\n        });\n      } else if (!options.skipInterpolation) {\n        // i18next.parsing\n        if (options.interpolation) this.interpolator.init(_objectSpread({}, options, {\n          interpolation: _objectSpread({}, this.options.interpolation, options.interpolation)\n        })); // interpolate\n\n        var data = options.replace && typeof options.replace !== 'string' ? options.replace : options;\n        if (this.options.interpolation.defaultVariables) data = _objectSpread({}, this.options.interpolation.defaultVariables, data);\n        res = this.interpolator.interpolate(res, data, options.lng || this.language, options); // nesting\n\n        if (options.nest !== false) res = this.interpolator.nest(res, function () {\n          return _this3.translate.apply(_this3, arguments);\n        }, options);\n        if (options.interpolation) this.interpolator.reset();\n      } // post process\n\n\n      var postProcess = options.postProcess || this.options.postProcess;\n      var postProcessorNames = typeof postProcess === 'string' ? [postProcess] : postProcess;\n\n      if (res !== undefined && res !== null && postProcessorNames && postProcessorNames.length && options.applyPostProcessor !== false) {\n        res = postProcessor.handle(postProcessorNames, res, key, options, this);\n      }\n\n      return res;\n    }\n  }, {\n    key: \"resolve\",\n    value: function resolve(keys) {\n      var _this4 = this;\n\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var found;\n      var usedKey; // plain key\n\n      var exactUsedKey; // key with context / plural\n\n      var usedLng;\n      var usedNS;\n      if (typeof keys === 'string') keys = [keys]; // forEach possible key\n\n      keys.forEach(function (k) {\n        if (_this4.isValidLookup(found)) return;\n\n        var extracted = _this4.extractFromKey(k, options);\n\n        var key = extracted.key;\n        usedKey = key;\n        var namespaces = extracted.namespaces;\n        if (_this4.options.fallbackNS) namespaces = namespaces.concat(_this4.options.fallbackNS);\n        var needsPluralHandling = options.count !== undefined && typeof options.count !== 'string';\n        var needsContextHandling = options.context !== undefined && typeof options.context === 'string' && options.context !== '';\n        var codes = options.lngs ? options.lngs : _this4.languageUtils.toResolveHierarchy(options.lng || _this4.language, options.fallbackLng);\n        namespaces.forEach(function (ns) {\n          if (_this4.isValidLookup(found)) return;\n          usedNS = ns;\n          codes.forEach(function (code) {\n            if (_this4.isValidLookup(found)) return;\n            usedLng = code;\n            var finalKey = key;\n            var finalKeys = [finalKey];\n\n            if (_this4.i18nFormat && _this4.i18nFormat.addLookupKeys) {\n              _this4.i18nFormat.addLookupKeys(finalKeys, key, code, ns, options);\n            } else {\n              var pluralSuffix;\n              if (needsPluralHandling) pluralSuffix = _this4.pluralResolver.getSuffix(code, options.count); // fallback for plural if context not found\n\n              if (needsPluralHandling && needsContextHandling) finalKeys.push(finalKey + pluralSuffix); // get key for context if needed\n\n              if (needsContextHandling) finalKeys.push(finalKey += \"\".concat(_this4.options.contextSeparator).concat(options.context)); // get key for plural if needed\n\n              if (needsPluralHandling) finalKeys.push(finalKey += pluralSuffix);\n            } // iterate over finalKeys starting with most specific pluralkey (-> contextkey only) -> singularkey only\n\n\n            var possibleKey;\n            /* eslint no-cond-assign: 0 */\n\n            while (possibleKey = finalKeys.pop()) {\n              if (!_this4.isValidLookup(found)) {\n                exactUsedKey = possibleKey;\n                found = _this4.getResource(code, ns, possibleKey, options);\n              }\n            }\n          });\n        });\n      });\n      return {\n        res: found,\n        usedKey: usedKey,\n        exactUsedKey: exactUsedKey,\n        usedLng: usedLng,\n        usedNS: usedNS\n      };\n    }\n  }, {\n    key: \"isValidLookup\",\n    value: function isValidLookup(res) {\n      return res !== undefined && !(!this.options.returnNull && res === null) && !(!this.options.returnEmptyString && res === '');\n    }\n  }, {\n    key: \"getResource\",\n    value: function getResource(code, ns, key) {\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      if (this.i18nFormat && this.i18nFormat.getResource) return this.i18nFormat.getResource(code, ns, key, options);\n      return this.resourceStore.getResource(code, ns, key, options);\n    }\n  }]);\n\n  return Translator;\n}(EventEmitter);\n\nexport default Translator;","map":{"version":3,"sources":["/projects/testswap/uniswap-interface/node_modules/i18next/dist/es/Translator.js"],"names":["_objectSpread","_typeof","_classCallCheck","_createClass","_possibleConstructorReturn","_getPrototypeOf","_inherits","_assertThisInitialized","baseLogger","EventEmitter","postProcessor","utils","Translator","_EventEmitter","services","_this","options","arguments","length","undefined","call","copy","keySeparator","logger","create","key","value","changeLanguage","lng","language","exists","interpolation","resolved","resolve","res","extractFromKey","nsSeparator","namespaces","ns","defaultNS","indexOf","parts","split","shift","join","translate","keys","_this2","overloadTranslationOptionHandler","Array","isArray","String","_this$extractFromKey","namespace","appendNamespaceToCIMode","toLowerCase","resUsedKey","usedKey","resExactUsedKey","exactUsedKey","resType","Object","prototype","toString","apply","noObject","joinArrays","handleAsObjectInI18nFormat","i18nFormat","handleAsObject","returnObjects","warn","returnedObjectHandler","concat","resTypeIsArray","newKeyToUse","m","hasOwnProperty","deepKey","extendTranslation","usedDefault","isValidLookup","defaultValue","count","suffix","pluralResolver","getSuffix","updateMissing","log","lngs","fallbackLngs","languageUtils","getFallbackCodes","fallbackLng","saveMissingTo","i","push","toResolveHierarchy","send","l","k","missingKeyHandler","backendConnector","saveMissing","emit","needsPluralHandling","saveMissingPlurals","forEach","plurals","getPluralFormsOfKey","p","appendNamespaceToMissingKey","parseMissingKeyHandler","_this3","parse","usedLng","usedNS","skipInterpolation","interpolator","init","data","replace","defaultVariables","interpolate","nest","reset","postProcess","postProcessorNames","applyPostProcessor","handle","_this4","found","extracted","fallbackNS","needsContextHandling","context","codes","code","finalKey","finalKeys","addLookupKeys","pluralSuffix","contextSeparator","possibleKey","pop","getResource","returnNull","returnEmptyString","resourceStore"],"mappings":"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","sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/objectSpread\";\nimport _typeof from \"@babel/runtime/helpers/typeof\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport baseLogger from './logger.js';\nimport EventEmitter from './EventEmitter.js';\nimport postProcessor from './postProcessor.js';\nimport * as utils from './utils.js';\n\nvar Translator =\n/*#__PURE__*/\nfunction (_EventEmitter) {\n  _inherits(Translator, _EventEmitter);\n\n  function Translator(services) {\n    var _this;\n\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Translator);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Translator).call(this));\n    EventEmitter.call(_assertThisInitialized(_assertThisInitialized(_this))); // <=IE10 fix (unable to call parent constructor)\n\n    utils.copy(['resourceStore', 'languageUtils', 'pluralResolver', 'interpolator', 'backendConnector', 'i18nFormat'], services, _assertThisInitialized(_assertThisInitialized(_this)));\n    _this.options = options;\n\n    if (_this.options.keySeparator === undefined) {\n      _this.options.keySeparator = '.';\n    }\n\n    _this.logger = baseLogger.create('translator');\n    return _this;\n  }\n\n  _createClass(Translator, [{\n    key: \"changeLanguage\",\n    value: function changeLanguage(lng) {\n      if (lng) this.language = lng;\n    }\n  }, {\n    key: \"exists\",\n    value: function exists(key) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n        interpolation: {}\n      };\n      var resolved = this.resolve(key, options);\n      return resolved && resolved.res !== undefined;\n    }\n  }, {\n    key: \"extractFromKey\",\n    value: function extractFromKey(key, options) {\n      var nsSeparator = options.nsSeparator || this.options.nsSeparator;\n      if (nsSeparator === undefined) nsSeparator = ':';\n      var keySeparator = options.keySeparator !== undefined ? options.keySeparator : this.options.keySeparator;\n      var namespaces = options.ns || this.options.defaultNS;\n\n      if (nsSeparator && key.indexOf(nsSeparator) > -1) {\n        var parts = key.split(nsSeparator);\n        if (nsSeparator !== keySeparator || nsSeparator === keySeparator && this.options.ns.indexOf(parts[0]) > -1) namespaces = parts.shift();\n        key = parts.join(keySeparator);\n      }\n\n      if (typeof namespaces === 'string') namespaces = [namespaces];\n      return {\n        key: key,\n        namespaces: namespaces\n      };\n    }\n  }, {\n    key: \"translate\",\n    value: function translate(keys, options) {\n      var _this2 = this;\n\n      if (_typeof(options) !== 'object' && this.options.overloadTranslationOptionHandler) {\n        /* eslint prefer-rest-params: 0 */\n        options = this.options.overloadTranslationOptionHandler(arguments);\n      }\n\n      if (!options) options = {}; // non valid keys handling\n\n      if (keys === undefined || keys === null) return '';\n      if (!Array.isArray(keys)) keys = [String(keys)]; // separators\n\n      var keySeparator = options.keySeparator !== undefined ? options.keySeparator : this.options.keySeparator; // get namespace(s)\n\n      var _this$extractFromKey = this.extractFromKey(keys[keys.length - 1], options),\n          key = _this$extractFromKey.key,\n          namespaces = _this$extractFromKey.namespaces;\n\n      var namespace = namespaces[namespaces.length - 1]; // return key on CIMode\n\n      var lng = options.lng || this.language;\n      var appendNamespaceToCIMode = options.appendNamespaceToCIMode || this.options.appendNamespaceToCIMode;\n\n      if (lng && lng.toLowerCase() === 'cimode') {\n        if (appendNamespaceToCIMode) {\n          var nsSeparator = options.nsSeparator || this.options.nsSeparator;\n          return namespace + nsSeparator + key;\n        }\n\n        return key;\n      } // resolve from store\n\n\n      var resolved = this.resolve(keys, options);\n      var res = resolved && resolved.res;\n      var resUsedKey = resolved && resolved.usedKey || key;\n      var resExactUsedKey = resolved && resolved.exactUsedKey || key;\n      var resType = Object.prototype.toString.apply(res);\n      var noObject = ['[object Number]', '[object Function]', '[object RegExp]'];\n      var joinArrays = options.joinArrays !== undefined ? options.joinArrays : this.options.joinArrays; // object\n\n      var handleAsObjectInI18nFormat = !this.i18nFormat || this.i18nFormat.handleAsObject;\n      var handleAsObject = typeof res !== 'string' && typeof res !== 'boolean' && typeof res !== 'number';\n\n      if (handleAsObjectInI18nFormat && res && handleAsObject && noObject.indexOf(resType) < 0 && !(typeof joinArrays === 'string' && resType === '[object Array]')) {\n        if (!options.returnObjects && !this.options.returnObjects) {\n          this.logger.warn('accessing an object - but returnObjects options is not enabled!');\n          return this.options.returnedObjectHandler ? this.options.returnedObjectHandler(resUsedKey, res, options) : \"key '\".concat(key, \" (\").concat(this.language, \")' returned an object instead of string.\");\n        } // if we got a separator we loop over children - else we just return object as is\n        // as having it set to false means no hierarchy so no lookup for nested values\n\n\n        if (keySeparator) {\n          var resTypeIsArray = resType === '[object Array]';\n          var copy = resTypeIsArray ? [] : {}; // apply child translation on a copy\n\n          /* eslint no-restricted-syntax: 0 */\n\n          var newKeyToUse = resTypeIsArray ? resExactUsedKey : resUsedKey;\n\n          for (var m in res) {\n            if (Object.prototype.hasOwnProperty.call(res, m)) {\n              var deepKey = \"\".concat(newKeyToUse).concat(keySeparator).concat(m);\n              copy[m] = this.translate(deepKey, _objectSpread({}, options, {\n                joinArrays: false,\n                ns: namespaces\n              }));\n              if (copy[m] === deepKey) copy[m] = res[m]; // if nothing found use orginal value as fallback\n            }\n          }\n\n          res = copy;\n        }\n      } else if (handleAsObjectInI18nFormat && typeof joinArrays === 'string' && resType === '[object Array]') {\n        // array special treatment\n        res = res.join(joinArrays);\n        if (res) res = this.extendTranslation(res, keys, options);\n      } else {\n        // string, empty or null\n        var usedDefault = false;\n        var usedKey = false; // fallback value\n\n        if (!this.isValidLookup(res) && options.defaultValue !== undefined) {\n          usedDefault = true;\n\n          if (options.count !== undefined) {\n            var suffix = this.pluralResolver.getSuffix(lng, options.count);\n            res = options[\"defaultValue\".concat(suffix)];\n          }\n\n          if (!res) res = options.defaultValue;\n        }\n\n        if (!this.isValidLookup(res)) {\n          usedKey = true;\n          res = key;\n        } // save missing\n\n\n        var updateMissing = options.defaultValue && options.defaultValue !== res && this.options.updateMissing;\n\n        if (usedKey || usedDefault || updateMissing) {\n          this.logger.log(updateMissing ? 'updateKey' : 'missingKey', lng, namespace, key, updateMissing ? options.defaultValue : res);\n          var lngs = [];\n          var fallbackLngs = this.languageUtils.getFallbackCodes(this.options.fallbackLng, options.lng || this.language);\n\n          if (this.options.saveMissingTo === 'fallback' && fallbackLngs && fallbackLngs[0]) {\n            for (var i = 0; i < fallbackLngs.length; i++) {\n              lngs.push(fallbackLngs[i]);\n            }\n          } else if (this.options.saveMissingTo === 'all') {\n            lngs = this.languageUtils.toResolveHierarchy(options.lng || this.language);\n          } else {\n            lngs.push(options.lng || this.language);\n          }\n\n          var send = function send(l, k) {\n            if (_this2.options.missingKeyHandler) {\n              _this2.options.missingKeyHandler(l, namespace, k, updateMissing ? options.defaultValue : res, updateMissing, options);\n            } else if (_this2.backendConnector && _this2.backendConnector.saveMissing) {\n              _this2.backendConnector.saveMissing(l, namespace, k, updateMissing ? options.defaultValue : res, updateMissing, options);\n            }\n\n            _this2.emit('missingKey', l, namespace, k, res);\n          };\n\n          if (this.options.saveMissing) {\n            var needsPluralHandling = options.count !== undefined && typeof options.count !== 'string';\n\n            if (this.options.saveMissingPlurals && needsPluralHandling) {\n              lngs.forEach(function (l) {\n                var plurals = _this2.pluralResolver.getPluralFormsOfKey(l, key);\n\n                plurals.forEach(function (p) {\n                  return send([l], p);\n                });\n              });\n            } else {\n              send(lngs, key);\n            }\n          }\n        } // extend\n\n\n        res = this.extendTranslation(res, keys, options, resolved); // append namespace if still key\n\n        if (usedKey && res === key && this.options.appendNamespaceToMissingKey) res = \"\".concat(namespace, \":\").concat(key); // parseMissingKeyHandler\n\n        if (usedKey && this.options.parseMissingKeyHandler) res = this.options.parseMissingKeyHandler(res);\n      } // return\n\n\n      return res;\n    }\n  }, {\n    key: \"extendTranslation\",\n    value: function extendTranslation(res, key, options, resolved) {\n      var _this3 = this;\n\n      if (this.i18nFormat && this.i18nFormat.parse) {\n        res = this.i18nFormat.parse(res, options, resolved.usedLng, resolved.usedNS, resolved.usedKey, {\n          resolved: resolved\n        });\n      } else if (!options.skipInterpolation) {\n        // i18next.parsing\n        if (options.interpolation) this.interpolator.init(_objectSpread({}, options, {\n          interpolation: _objectSpread({}, this.options.interpolation, options.interpolation)\n        })); // interpolate\n\n        var data = options.replace && typeof options.replace !== 'string' ? options.replace : options;\n        if (this.options.interpolation.defaultVariables) data = _objectSpread({}, this.options.interpolation.defaultVariables, data);\n        res = this.interpolator.interpolate(res, data, options.lng || this.language, options); // nesting\n\n        if (options.nest !== false) res = this.interpolator.nest(res, function () {\n          return _this3.translate.apply(_this3, arguments);\n        }, options);\n        if (options.interpolation) this.interpolator.reset();\n      } // post process\n\n\n      var postProcess = options.postProcess || this.options.postProcess;\n      var postProcessorNames = typeof postProcess === 'string' ? [postProcess] : postProcess;\n\n      if (res !== undefined && res !== null && postProcessorNames && postProcessorNames.length && options.applyPostProcessor !== false) {\n        res = postProcessor.handle(postProcessorNames, res, key, options, this);\n      }\n\n      return res;\n    }\n  }, {\n    key: \"resolve\",\n    value: function resolve(keys) {\n      var _this4 = this;\n\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var found;\n      var usedKey; // plain key\n\n      var exactUsedKey; // key with context / plural\n\n      var usedLng;\n      var usedNS;\n      if (typeof keys === 'string') keys = [keys]; // forEach possible key\n\n      keys.forEach(function (k) {\n        if (_this4.isValidLookup(found)) return;\n\n        var extracted = _this4.extractFromKey(k, options);\n\n        var key = extracted.key;\n        usedKey = key;\n        var namespaces = extracted.namespaces;\n        if (_this4.options.fallbackNS) namespaces = namespaces.concat(_this4.options.fallbackNS);\n        var needsPluralHandling = options.count !== undefined && typeof options.count !== 'string';\n        var needsContextHandling = options.context !== undefined && typeof options.context === 'string' && options.context !== '';\n        var codes = options.lngs ? options.lngs : _this4.languageUtils.toResolveHierarchy(options.lng || _this4.language, options.fallbackLng);\n        namespaces.forEach(function (ns) {\n          if (_this4.isValidLookup(found)) return;\n          usedNS = ns;\n          codes.forEach(function (code) {\n            if (_this4.isValidLookup(found)) return;\n            usedLng = code;\n            var finalKey = key;\n            var finalKeys = [finalKey];\n\n            if (_this4.i18nFormat && _this4.i18nFormat.addLookupKeys) {\n              _this4.i18nFormat.addLookupKeys(finalKeys, key, code, ns, options);\n            } else {\n              var pluralSuffix;\n              if (needsPluralHandling) pluralSuffix = _this4.pluralResolver.getSuffix(code, options.count); // fallback for plural if context not found\n\n              if (needsPluralHandling && needsContextHandling) finalKeys.push(finalKey + pluralSuffix); // get key for context if needed\n\n              if (needsContextHandling) finalKeys.push(finalKey += \"\".concat(_this4.options.contextSeparator).concat(options.context)); // get key for plural if needed\n\n              if (needsPluralHandling) finalKeys.push(finalKey += pluralSuffix);\n            } // iterate over finalKeys starting with most specific pluralkey (-> contextkey only) -> singularkey only\n\n\n            var possibleKey;\n            /* eslint no-cond-assign: 0 */\n\n            while (possibleKey = finalKeys.pop()) {\n              if (!_this4.isValidLookup(found)) {\n                exactUsedKey = possibleKey;\n                found = _this4.getResource(code, ns, possibleKey, options);\n              }\n            }\n          });\n        });\n      });\n      return {\n        res: found,\n        usedKey: usedKey,\n        exactUsedKey: exactUsedKey,\n        usedLng: usedLng,\n        usedNS: usedNS\n      };\n    }\n  }, {\n    key: \"isValidLookup\",\n    value: function isValidLookup(res) {\n      return res !== undefined && !(!this.options.returnNull && res === null) && !(!this.options.returnEmptyString && res === '');\n    }\n  }, {\n    key: \"getResource\",\n    value: function getResource(code, ns, key) {\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      if (this.i18nFormat && this.i18nFormat.getResource) return this.i18nFormat.getResource(code, ns, key, options);\n      return this.resourceStore.getResource(code, ns, key, options);\n    }\n  }]);\n\n  return Translator;\n}(EventEmitter);\n\nexport default Translator;"]},"metadata":{},"sourceType":"module"}