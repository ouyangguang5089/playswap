{"ast":null,"code":"import _regeneratorRuntime from\"/projects/testswap/uniswap-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/projects/testswap/uniswap-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/projects/testswap/uniswap-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/projects/testswap/uniswap-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject4(){var data=_taggedTemplateLiteral([\"\\n  padding: 60px 0;\\n\"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  padding: 24px;\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  :hover {\\n    cursor: pointer;\\n  }\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  padding: 24px;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useState,useContext}from'react';import{useActiveWeb3React}from'../../hooks';import Modal from'../Modal';import{AutoColumn,ColumnCenter}from'../Column';import styled,{ThemeContext}from'styled-components';import{RowBetween}from'../Row';import{TYPE,CustomLightSpinner}from'../../theme';import{X,ArrowUpCircle}from'react-feather';import{ButtonPrimary}from'../Button';import Circle from\"../../assets/images/blue-loader.svg\";import{useVoteCallback,useUserVotes}from'../../state/governance/hooks';import{getEtherscanLink}from'../../utils';import{ExternalLink}from'../../theme/components';var ContentWrapper=styled(AutoColumn)(_templateObject());var StyledClosed=styled(X)(_templateObject2());var ConfirmOrLoadingWrapper=styled.div(_templateObject3());var ConfirmedIcon=styled(ColumnCenter)(_templateObject4());export default function VoteModal(_ref){var isOpen=_ref.isOpen,onDismiss=_ref.onDismiss,proposalId=_ref.proposalId,support=_ref.support;var _useActiveWeb3React=useActiveWeb3React(),chainId=_useActiveWeb3React.chainId;var _useVoteCallback=useVoteCallback(),voteCallback=_useVoteCallback.voteCallback;var availableVotes=useUserVotes();// monitor call to help UI loading state\nvar _useState=useState(),_useState2=_slicedToArray(_useState,2),hash=_useState2[0],setHash=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),attempting=_useState4[0],setAttempting=_useState4[1];// get theme for colors\nvar theme=useContext(ThemeContext);// wrapper to reset state on modal close\nfunction wrappedOndismiss(){setHash(undefined);setAttempting(false);onDismiss();}function onVote(){return _onVote.apply(this,arguments);}function _onVote(){_onVote=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _voteCallback;var hash;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setAttempting(true);// if callback not returned properly ignore\nif(voteCallback){_context.next=3;break;}return _context.abrupt(\"return\");case 3:_context.next=5;return(_voteCallback=voteCallback(proposalId,support))===null||_voteCallback===void 0?void 0:_voteCallback.catch(function(error){setAttempting(false);console.log(error);});case 5:hash=_context.sent;if(hash){setHash(hash);}case 7:case\"end\":return _context.stop();}}},_callee);}));return _onVote.apply(this,arguments);}return/*#__PURE__*/React.createElement(Modal,{isOpen:isOpen,onDismiss:wrappedOndismiss,maxHeight:90},!attempting&&!hash&&/*#__PURE__*/React.createElement(ContentWrapper,{gap:\"lg\"},/*#__PURE__*/React.createElement(AutoColumn,{gap:\"lg\",justify:\"center\"},/*#__PURE__*/React.createElement(RowBetween,null,/*#__PURE__*/React.createElement(TYPE.mediumHeader,{fontWeight:500},\"Vote \".concat(support?'for ':'against',\" proposal \").concat(proposalId)),/*#__PURE__*/React.createElement(StyledClosed,{stroke:\"black\",onClick:wrappedOndismiss})),/*#__PURE__*/React.createElement(TYPE.largeHeader,null,availableVotes===null||availableVotes===void 0?void 0:availableVotes.toSignificant(4),\" Votes\"),/*#__PURE__*/React.createElement(ButtonPrimary,{onClick:onVote},/*#__PURE__*/React.createElement(TYPE.mediumHeader,{color:\"white\"},\"Vote \".concat(support?'for ':'against',\" proposal  \").concat(proposalId))))),attempting&&!hash&&/*#__PURE__*/React.createElement(ConfirmOrLoadingWrapper,null,/*#__PURE__*/React.createElement(RowBetween,null,/*#__PURE__*/React.createElement(\"div\",null),/*#__PURE__*/React.createElement(StyledClosed,{onClick:wrappedOndismiss})),/*#__PURE__*/React.createElement(ConfirmedIcon,null,/*#__PURE__*/React.createElement(CustomLightSpinner,{src:Circle,alt:\"loader\",size:'90px'})),/*#__PURE__*/React.createElement(AutoColumn,{gap:\"100px\",justify:'center'},/*#__PURE__*/React.createElement(AutoColumn,{gap:\"12px\",justify:'center'},/*#__PURE__*/React.createElement(TYPE.largeHeader,null,\"Submitting Vote\")),/*#__PURE__*/React.createElement(TYPE.subHeader,null,\"Confirm this transaction in your wallet\"))),hash&&/*#__PURE__*/React.createElement(ConfirmOrLoadingWrapper,null,/*#__PURE__*/React.createElement(RowBetween,null,/*#__PURE__*/React.createElement(\"div\",null),/*#__PURE__*/React.createElement(StyledClosed,{onClick:wrappedOndismiss})),/*#__PURE__*/React.createElement(ConfirmedIcon,null,/*#__PURE__*/React.createElement(ArrowUpCircle,{strokeWidth:0.5,size:90,color:theme.primary1})),/*#__PURE__*/React.createElement(AutoColumn,{gap:\"100px\",justify:'center'},/*#__PURE__*/React.createElement(AutoColumn,{gap:\"12px\",justify:'center'},/*#__PURE__*/React.createElement(TYPE.largeHeader,null,\"Transaction Submitted\")),chainId&&/*#__PURE__*/React.createElement(ExternalLink,{href:getEtherscanLink(chainId,hash,'transaction'),style:{marginLeft:'4px'}},/*#__PURE__*/React.createElement(TYPE.subHeader,null,\"View transaction on Etherscan\")))));}","map":{"version":3,"sources":["/projects/testswap/uniswap-interface/src/components/vote/VoteModal.tsx"],"names":["React","useState","useContext","useActiveWeb3React","Modal","AutoColumn","ColumnCenter","styled","ThemeContext","RowBetween","TYPE","CustomLightSpinner","X","ArrowUpCircle","ButtonPrimary","useVoteCallback","useUserVotes","getEtherscanLink","ExternalLink","ContentWrapper","StyledClosed","ConfirmOrLoadingWrapper","div","ConfirmedIcon","VoteModal","isOpen","onDismiss","proposalId","support","chainId","voteCallback","availableVotes","hash","setHash","attempting","setAttempting","theme","wrappedOndismiss","undefined","onVote","catch","error","console","log","toSignificant","Circle","primary1","marginLeft"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from 'react'\nimport { useActiveWeb3React } from '../../hooks'\n\nimport Modal from '../Modal'\nimport { AutoColumn, ColumnCenter } from '../Column'\nimport styled, { ThemeContext } from 'styled-components'\nimport { RowBetween } from '../Row'\nimport { TYPE, CustomLightSpinner } from '../../theme'\nimport { X, ArrowUpCircle } from 'react-feather'\nimport { ButtonPrimary } from '../Button'\nimport Circle from '../../assets/images/blue-loader.svg'\nimport { useVoteCallback, useUserVotes } from '../../state/governance/hooks'\nimport { getEtherscanLink } from '../../utils'\nimport { ExternalLink } from '../../theme/components'\nimport { TokenAmount } from '@uniswap/sdk'\n\nconst ContentWrapper = styled(AutoColumn)`\n  width: 100%;\n  padding: 24px;\n`\n\nconst StyledClosed = styled(X)`\n  :hover {\n    cursor: pointer;\n  }\n`\n\nconst ConfirmOrLoadingWrapper = styled.div`\n  width: 100%;\n  padding: 24px;\n`\n\nconst ConfirmedIcon = styled(ColumnCenter)`\n  padding: 60px 0;\n`\n\ninterface VoteModalProps {\n  isOpen: boolean\n  onDismiss: () => void\n  support: boolean // if user is for or against proposal\n  proposalId: string | undefined // id for the proposal to vote on\n}\n\nexport default function VoteModal({ isOpen, onDismiss, proposalId, support }: VoteModalProps) {\n  const { chainId } = useActiveWeb3React()\n  const {\n    voteCallback\n  }: {\n    voteCallback: (proposalId: string | undefined, support: boolean) => Promise<string> | undefined\n  } = useVoteCallback()\n  const availableVotes: TokenAmount | undefined = useUserVotes()\n\n  // monitor call to help UI loading state\n  const [hash, setHash] = useState<string | undefined>()\n  const [attempting, setAttempting] = useState<boolean>(false)\n\n  // get theme for colors\n  const theme = useContext(ThemeContext)\n\n  // wrapper to reset state on modal close\n  function wrappedOndismiss() {\n    setHash(undefined)\n    setAttempting(false)\n    onDismiss()\n  }\n\n  async function onVote() {\n    setAttempting(true)\n\n    // if callback not returned properly ignore\n    if (!voteCallback) return\n\n    // try delegation and store hash\n    const hash = await voteCallback(proposalId, support)?.catch(error => {\n      setAttempting(false)\n      console.log(error)\n    })\n\n    if (hash) {\n      setHash(hash)\n    }\n  }\n\n  return (\n    <Modal isOpen={isOpen} onDismiss={wrappedOndismiss} maxHeight={90}>\n      {!attempting && !hash && (\n        <ContentWrapper gap=\"lg\">\n          <AutoColumn gap=\"lg\" justify=\"center\">\n            <RowBetween>\n              <TYPE.mediumHeader fontWeight={500}>{`Vote ${\n                support ? 'for ' : 'against'\n              } proposal ${proposalId}`}</TYPE.mediumHeader>\n              <StyledClosed stroke=\"black\" onClick={wrappedOndismiss} />\n            </RowBetween>\n            <TYPE.largeHeader>{availableVotes?.toSignificant(4)} Votes</TYPE.largeHeader>\n            <ButtonPrimary onClick={onVote}>\n              <TYPE.mediumHeader color=\"white\">{`Vote ${\n                support ? 'for ' : 'against'\n              } proposal  ${proposalId}`}</TYPE.mediumHeader>\n            </ButtonPrimary>\n          </AutoColumn>\n        </ContentWrapper>\n      )}\n      {attempting && !hash && (\n        <ConfirmOrLoadingWrapper>\n          <RowBetween>\n            <div />\n            <StyledClosed onClick={wrappedOndismiss} />\n          </RowBetween>\n          <ConfirmedIcon>\n            <CustomLightSpinner src={Circle} alt=\"loader\" size={'90px'} />\n          </ConfirmedIcon>\n          <AutoColumn gap=\"100px\" justify={'center'}>\n            <AutoColumn gap=\"12px\" justify={'center'}>\n              <TYPE.largeHeader>Submitting Vote</TYPE.largeHeader>\n            </AutoColumn>\n            <TYPE.subHeader>Confirm this transaction in your wallet</TYPE.subHeader>\n          </AutoColumn>\n        </ConfirmOrLoadingWrapper>\n      )}\n      {hash && (\n        <ConfirmOrLoadingWrapper>\n          <RowBetween>\n            <div />\n            <StyledClosed onClick={wrappedOndismiss} />\n          </RowBetween>\n          <ConfirmedIcon>\n            <ArrowUpCircle strokeWidth={0.5} size={90} color={theme.primary1} />\n          </ConfirmedIcon>\n          <AutoColumn gap=\"100px\" justify={'center'}>\n            <AutoColumn gap=\"12px\" justify={'center'}>\n              <TYPE.largeHeader>Transaction Submitted</TYPE.largeHeader>\n            </AutoColumn>\n            {chainId && (\n              <ExternalLink href={getEtherscanLink(chainId, hash, 'transaction')} style={{ marginLeft: '4px' }}>\n                <TYPE.subHeader>View transaction on Etherscan</TYPE.subHeader>\n              </ExternalLink>\n            )}\n          </AutoColumn>\n        </ConfirmOrLoadingWrapper>\n      )}\n    </Modal>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}