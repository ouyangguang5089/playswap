{"ast":null,"code":"import _toConsumableArray from\"/projects/testswap/uniswap-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/projects/testswap/uniswap-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/projects/testswap/uniswap-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  border-radius: 20px;\\n  padding: 20px;\\n  border-top-left-radius: 0;\\n  border-top-right-radius: 0;\\n  background-color: \",\";\\n  border-top: 1px solid \",\";\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  flex: 1 1;\\n  position: relative;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import{ETHER}from'@uniswap/sdk';import React,{useCallback,useEffect,useMemo,useRef,useState}from'react';import ReactGA from'react-ga';import{useTranslation}from'react-i18next';import{Text}from'rebass';import{useActiveWeb3React}from'../../hooks';import{useAllTokens,useToken,useIsUserAddedToken,useFoundOnInactiveList}from'../../hooks/Tokens';import{CloseIcon,TYPE,ButtonText,IconWrapper}from'../../theme';import{isAddress}from'../../utils';import Column from'../Column';import Row,{RowBetween,RowFixed}from'../Row';import CommonBases from'./CommonBases';import CurrencyList from'./CurrencyList';import{filterTokens}from'./filtering';import{useTokenComparator}from'./sorting';import{PaddedColumn,SearchInput,Separator}from'./styleds';import AutoSizer from'react-virtualized-auto-sizer';import styled from'styled-components';import useToggle from'hooks/useToggle';import{useOnClickOutside}from'hooks/useOnClickOutside';import useTheme from'hooks/useTheme';import ImportRow from'./ImportRow';import{Edit}from'react-feather';import{ButtonLight}from'components/Button';var ContentWrapper=styled(Column)(_templateObject());var Footer=styled.div(_templateObject2(),function(_ref){var theme=_ref.theme;return theme.bg1;},function(_ref2){var theme=_ref2.theme;return theme.bg2;});export function CurrencySearch(_ref3){var selectedCurrency=_ref3.selectedCurrency,onCurrencySelect=_ref3.onCurrencySelect,otherSelectedCurrency=_ref3.otherSelectedCurrency,showCommonBases=_ref3.showCommonBases,onDismiss=_ref3.onDismiss,isOpen=_ref3.isOpen,showManageView=_ref3.showManageView,showImportView=_ref3.showImportView,setImportToken=_ref3.setImportToken;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useActiveWeb3React=useActiveWeb3React(),chainId=_useActiveWeb3React.chainId;var theme=useTheme();// refs for fixed size lists\nvar fixedList=useRef();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),searchQuery=_useState2[0],setSearchQuery=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,1),invertSearchOrder=_useState4[0];var allTokens=useAllTokens();// const inactiveTokens: Token[] | undefined = useFoundOnInactiveList(searchQuery)\n// if they input an address, use it\nvar isAddressSearch=isAddress(searchQuery);var searchToken=useToken(searchQuery);var searchTokenIsAdded=useIsUserAddedToken(searchToken);useEffect(function(){if(isAddressSearch){ReactGA.event({category:'Currency Select',action:'Search by address',label:isAddressSearch});}},[isAddressSearch]);var showETH=useMemo(function(){var s=searchQuery.toLowerCase().trim();return s===''||s==='e'||s==='et'||s==='eth';},[searchQuery]);var tokenComparator=useTokenComparator(invertSearchOrder);var filteredTokens=useMemo(function(){return filterTokens(Object.values(allTokens),searchQuery);},[allTokens,searchQuery]);var filteredSortedTokens=useMemo(function(){var sorted=filteredTokens.sort(tokenComparator);var symbolMatch=searchQuery.toLowerCase().split(/\\s+/).filter(function(s){return s.length>0;});if(symbolMatch.length>1){return sorted;}return[].concat(_toConsumableArray(sorted.filter(function(token){var _token$symbol;return((_token$symbol=token.symbol)===null||_token$symbol===void 0?void 0:_token$symbol.toLowerCase())===symbolMatch[0];})),_toConsumableArray(sorted.filter(function(token){var _token$symbol2,_token$symbol3;return((_token$symbol2=token.symbol)===null||_token$symbol2===void 0?void 0:_token$symbol2.toLowerCase().startsWith(searchQuery.toLowerCase().trim()))&&((_token$symbol3=token.symbol)===null||_token$symbol3===void 0?void 0:_token$symbol3.toLowerCase())!==symbolMatch[0];})),_toConsumableArray(sorted.filter(function(token){var _token$symbol4,_token$symbol5;return!((_token$symbol4=token.symbol)===null||_token$symbol4===void 0?void 0:_token$symbol4.toLowerCase().startsWith(searchQuery.toLowerCase().trim()))&&((_token$symbol5=token.symbol)===null||_token$symbol5===void 0?void 0:_token$symbol5.toLowerCase())!==symbolMatch[0];})));},[filteredTokens,searchQuery,tokenComparator]);var handleCurrencySelect=useCallback(function(currency){onCurrencySelect(currency);onDismiss();},[onDismiss,onCurrencySelect]);// clear the input on open\nuseEffect(function(){if(isOpen)setSearchQuery('');},[isOpen]);// manage focus on modal show\nvar inputRef=useRef();var handleInput=useCallback(function(event){var _fixedList$current;var input=event.target.value;var checksummedInput=isAddress(input);setSearchQuery(checksummedInput||input);(_fixedList$current=fixedList.current)===null||_fixedList$current===void 0?void 0:_fixedList$current.scrollTo(0);},[]);var handleEnter=useCallback(function(e){if(e.key==='Enter'){var s=searchQuery.toLowerCase().trim();if(s==='eth'){handleCurrencySelect(ETHER);}else if(filteredSortedTokens.length>0){var _filteredSortedTokens;if(((_filteredSortedTokens=filteredSortedTokens[0].symbol)===null||_filteredSortedTokens===void 0?void 0:_filteredSortedTokens.toLowerCase())===searchQuery.trim().toLowerCase()||filteredSortedTokens.length===1){handleCurrencySelect(filteredSortedTokens[0]);}}}},[filteredSortedTokens,handleCurrencySelect,searchQuery]);// menu ui\nvar _useToggle=useToggle(false),_useToggle2=_slicedToArray(_useToggle,2),open=_useToggle2[0],toggle=_useToggle2[1];var node=useRef();useOnClickOutside(node,open?toggle:undefined);// if no results on main list, show option to expand into inactive\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showExpanded=_useState6[0],setShowExpanded=_useState6[1];var inactiveTokens=useFoundOnInactiveList(searchQuery);// reset expanded results on query reset\nuseEffect(function(){if(searchQuery===''){setShowExpanded(false);}},[setShowExpanded,searchQuery]);return/*#__PURE__*/React.createElement(ContentWrapper,null,/*#__PURE__*/React.createElement(PaddedColumn,{gap:\"16px\"},/*#__PURE__*/React.createElement(RowBetween,null,/*#__PURE__*/React.createElement(Text,{fontWeight:500,fontSize:16},\"Select a token\"),/*#__PURE__*/React.createElement(CloseIcon,{onClick:onDismiss})),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(SearchInput,{type:\"text\",id:\"token-search-input\",placeholder:t('tokenSearchPlaceholder'),autoComplete:\"off\",value:searchQuery,ref:inputRef,onChange:handleInput,onKeyDown:handleEnter})),showCommonBases&&/*#__PURE__*/React.createElement(CommonBases,{chainId:chainId,onSelect:handleCurrencySelect,selectedCurrency:selectedCurrency})),/*#__PURE__*/React.createElement(Separator,null),searchToken&&!searchTokenIsAdded?/*#__PURE__*/React.createElement(Column,{style:{padding:'20px 0',height:'100%'}},/*#__PURE__*/React.createElement(ImportRow,{token:searchToken,showImportView:showImportView,setImportToken:setImportToken})):(filteredSortedTokens===null||filteredSortedTokens===void 0?void 0:filteredSortedTokens.length)>0||showExpanded&&inactiveTokens&&inactiveTokens.length>0?/*#__PURE__*/React.createElement(\"div\",{style:{flex:'1'}},/*#__PURE__*/React.createElement(AutoSizer,{disableWidth:true},function(_ref4){var height=_ref4.height;return/*#__PURE__*/React.createElement(CurrencyList,{height:height,showETH:showETH,currencies:showExpanded&&inactiveTokens?filteredSortedTokens.concat(inactiveTokens):filteredSortedTokens,onCurrencySelect:handleCurrencySelect,otherCurrency:otherSelectedCurrency,selectedCurrency:selectedCurrency,fixedListRef:fixedList,showImportView:showImportView,setImportToken:setImportToken});})):/*#__PURE__*/React.createElement(Column,{style:{padding:'20px',height:'100%'}},/*#__PURE__*/React.createElement(TYPE.main,{color:theme.text3,textAlign:\"center\",mb:\"20px\"},\"No results found in active lists.\"),inactiveTokens&&inactiveTokens.length>0&&!(searchToken&&!searchTokenIsAdded)&&searchQuery.length>1&&(filteredSortedTokens===null||filteredSortedTokens===void 0?void 0:filteredSortedTokens.length)===0&&/*#__PURE__*/ // expand button in line with no results\nReact.createElement(Row,{align:\"center\",width:\"100%\",justify:\"center\"},/*#__PURE__*/React.createElement(ButtonLight,{width:\"fit-content\",borderRadius:\"12px\",padding:\"8px 12px\",onClick:function onClick(){return setShowExpanded(!showExpanded);}},!showExpanded?\"Show \".concat(inactiveTokens.length,\" more inactive \").concat(inactiveTokens.length===1?'token':'tokens'):'Hide expanded search'))),inactiveTokens&&inactiveTokens.length>0&&!(searchToken&&!searchTokenIsAdded)&&(searchQuery.length>1||showExpanded)&&((filteredSortedTokens===null||filteredSortedTokens===void 0?void 0:filteredSortedTokens.length)!==0||showExpanded)&&/*#__PURE__*/ // button fixed to bottom\nReact.createElement(Row,{align:\"center\",width:\"100%\",justify:\"center\",style:{position:'absolute',bottom:'80px',left:0}},/*#__PURE__*/React.createElement(ButtonLight,{width:\"fit-content\",borderRadius:\"12px\",padding:\"8px 12px\",onClick:function onClick(){return setShowExpanded(!showExpanded);}},!showExpanded?\"Show \".concat(inactiveTokens.length,\" more inactive \").concat(inactiveTokens.length===1?'token':'tokens'):'Hide expanded search')),/*#__PURE__*/React.createElement(Footer,null,/*#__PURE__*/React.createElement(Row,{justify:\"center\"},/*#__PURE__*/React.createElement(ButtonText,{onClick:showManageView,color:theme.blue1,className:\"list-token-manage-button\"},/*#__PURE__*/React.createElement(RowFixed,null,/*#__PURE__*/React.createElement(IconWrapper,{size:\"16px\",marginRight:\"6px\"},/*#__PURE__*/React.createElement(Edit,null)),/*#__PURE__*/React.createElement(TYPE.main,{color:theme.blue1},\"Manage\"))))));}","map":{"version":3,"sources":["/projects/testswap/uniswap-interface/src/components/SearchModal/CurrencySearch.tsx"],"names":["ETHER","React","useCallback","useEffect","useMemo","useRef","useState","ReactGA","useTranslation","Text","useActiveWeb3React","useAllTokens","useToken","useIsUserAddedToken","useFoundOnInactiveList","CloseIcon","TYPE","ButtonText","IconWrapper","isAddress","Column","Row","RowBetween","RowFixed","CommonBases","CurrencyList","filterTokens","useTokenComparator","PaddedColumn","SearchInput","Separator","AutoSizer","styled","useToggle","useOnClickOutside","useTheme","ImportRow","Edit","ButtonLight","ContentWrapper","Footer","div","theme","bg1","bg2","CurrencySearch","selectedCurrency","onCurrencySelect","otherSelectedCurrency","showCommonBases","onDismiss","isOpen","showManageView","showImportView","setImportToken","t","chainId","fixedList","searchQuery","setSearchQuery","invertSearchOrder","allTokens","isAddressSearch","searchToken","searchTokenIsAdded","event","category","action","label","showETH","s","toLowerCase","trim","tokenComparator","filteredTokens","Object","values","filteredSortedTokens","sorted","sort","symbolMatch","split","filter","length","token","symbol","startsWith","handleCurrencySelect","currency","inputRef","handleInput","input","target","value","checksummedInput","current","scrollTo","handleEnter","e","key","open","toggle","node","undefined","showExpanded","setShowExpanded","inactiveTokens","padding","height","flex","concat","text3","position","bottom","left","blue1"],"mappings":"k+BAAA,OAAmBA,KAAnB,KAAuC,cAAvC,CACA,MAAOC,CAAAA,KAAP,EAA0CC,WAA1C,CAAuDC,SAAvD,CAAkEC,OAAlE,CAA2EC,MAA3E,CAAmFC,QAAnF,KAAmG,OAAnG,CACA,MAAOC,CAAAA,OAAP,KAAoB,UAApB,CACA,OAASC,cAAT,KAA+B,eAA/B,CAEA,OAASC,IAAT,KAAqB,QAArB,CACA,OAASC,kBAAT,KAAmC,aAAnC,CACA,OAASC,YAAT,CAAuBC,QAAvB,CAAiCC,mBAAjC,CAAsDC,sBAAtD,KAAoF,oBAApF,CACA,OAASC,SAAT,CAAoBC,IAApB,CAA0BC,UAA1B,CAAsCC,WAAtC,KAAyD,aAAzD,CACA,OAASC,SAAT,KAA0B,aAA1B,CACA,MAAOC,CAAAA,MAAP,KAAmB,WAAnB,CACA,MAAOC,CAAAA,GAAP,EAAcC,UAAd,CAA0BC,QAA1B,KAA0C,QAA1C,CACA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,CACA,MAAOC,CAAAA,YAAP,KAAyB,gBAAzB,CACA,OAASC,YAAT,KAA6B,aAA7B,CACA,OAASC,kBAAT,KAAmC,WAAnC,CACA,OAASC,YAAT,CAAuBC,WAAvB,CAAoCC,SAApC,KAAqD,WAArD,CACA,MAAOC,CAAAA,SAAP,KAAsB,8BAAtB,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CACA,MAAOC,CAAAA,SAAP,KAAsB,iBAAtB,CACA,OAASC,iBAAT,KAAkC,yBAAlC,CACA,MAAOC,CAAAA,QAAP,KAAqB,gBAArB,CACA,MAAOC,CAAAA,SAAP,KAAsB,aAAtB,CACA,OAASC,IAAT,KAAqB,eAArB,CACA,OAASC,WAAT,KAA4B,mBAA5B,CAEA,GAAMC,CAAAA,cAAc,CAAGP,MAAM,CAACZ,MAAD,CAAT,mBAApB,CAMA,GAAMoB,CAAAA,MAAM,CAAGR,MAAM,CAACS,GAAV,oBAMU,kBAAGC,CAAAA,KAAH,MAAGA,KAAH,OAAeA,CAAAA,KAAK,CAACC,GAArB,EANV,CAOc,mBAAGD,CAAAA,KAAH,OAAGA,KAAH,OAAeA,CAAAA,KAAK,CAACE,GAArB,EAPd,CAAZ,CAsBA,MAAO,SAASC,CAAAA,cAAT,OAUiB,IATtBC,CAAAA,gBASsB,OATtBA,gBASsB,CARtBC,gBAQsB,OARtBA,gBAQsB,CAPtBC,qBAOsB,OAPtBA,qBAOsB,CANtBC,eAMsB,OANtBA,eAMsB,CALtBC,SAKsB,OALtBA,SAKsB,CAJtBC,MAIsB,OAJtBA,MAIsB,CAHtBC,cAGsB,OAHtBA,cAGsB,CAFtBC,cAEsB,OAFtBA,cAEsB,CADtBC,cACsB,OADtBA,cACsB,qBACR9C,cAAc,EADN,CACd+C,CADc,iBACdA,CADc,yBAEF7C,kBAAkB,EAFhB,CAEd8C,OAFc,qBAEdA,OAFc,CAGtB,GAAMd,CAAAA,KAAK,CAAGP,QAAQ,EAAtB,CAEA;AACA,GAAMsB,CAAAA,SAAS,CAAGpD,MAAM,EAAxB,CANsB,cAQgBC,QAAQ,CAAS,EAAT,CARxB,wCAQfoD,WARe,eAQFC,cARE,8BASMrD,QAAQ,CAAU,KAAV,CATd,yCASfsD,iBATe,eAWtB,GAAMC,CAAAA,SAAS,CAAGlD,YAAY,EAA9B,CACA;AAEA;AACA,GAAMmD,CAAAA,eAAe,CAAG3C,SAAS,CAACuC,WAAD,CAAjC,CACA,GAAMK,CAAAA,WAAW,CAAGnD,QAAQ,CAAC8C,WAAD,CAA5B,CACA,GAAMM,CAAAA,kBAAkB,CAAGnD,mBAAmB,CAACkD,WAAD,CAA9C,CAEA5D,SAAS,CAAC,UAAM,CACd,GAAI2D,eAAJ,CAAqB,CACnBvD,OAAO,CAAC0D,KAAR,CAAc,CACZC,QAAQ,CAAE,iBADE,CAEZC,MAAM,CAAE,mBAFI,CAGZC,KAAK,CAAEN,eAHK,CAAd,EAKD,CACF,CARQ,CAQN,CAACA,eAAD,CARM,CAAT,CAUA,GAAMO,CAAAA,OAAgB,CAAGjE,OAAO,CAAC,UAAM,CACrC,GAAMkE,CAAAA,CAAC,CAAGZ,WAAW,CAACa,WAAZ,GAA0BC,IAA1B,EAAV,CACA,MAAOF,CAAAA,CAAC,GAAK,EAAN,EAAYA,CAAC,GAAK,GAAlB,EAAyBA,CAAC,GAAK,IAA/B,EAAuCA,CAAC,GAAK,KAApD,CACD,CAH+B,CAG7B,CAACZ,WAAD,CAH6B,CAAhC,CAKA,GAAMe,CAAAA,eAAe,CAAG9C,kBAAkB,CAACiC,iBAAD,CAA1C,CAEA,GAAMc,CAAAA,cAAuB,CAAGtE,OAAO,CAAC,UAAM,CAC5C,MAAOsB,CAAAA,YAAY,CAACiD,MAAM,CAACC,MAAP,CAAcf,SAAd,CAAD,CAA2BH,WAA3B,CAAnB,CACD,CAFsC,CAEpC,CAACG,SAAD,CAAYH,WAAZ,CAFoC,CAAvC,CAIA,GAAMmB,CAAAA,oBAA6B,CAAGzE,OAAO,CAAC,UAAM,CAClD,GAAM0E,CAAAA,MAAM,CAAGJ,cAAc,CAACK,IAAf,CAAoBN,eAApB,CAAf,CACA,GAAMO,CAAAA,WAAW,CAAGtB,WAAW,CAC5Ba,WADiB,GAEjBU,KAFiB,CAEX,KAFW,EAGjBC,MAHiB,CAGV,SAAAZ,CAAC,QAAIA,CAAAA,CAAC,CAACa,MAAF,CAAW,CAAf,EAHS,CAApB,CAKA,GAAIH,WAAW,CAACG,MAAZ,CAAqB,CAAzB,CAA4B,CAC1B,MAAOL,CAAAA,MAAP,CACD,CAED,mCAEKA,MAAM,CAACI,MAAP,CAAc,SAAAE,KAAK,0BAAI,gBAAAA,KAAK,CAACC,MAAN,sDAAcd,WAAd,MAAgCS,WAAW,CAAC,CAAD,CAA/C,EAAnB,CAFL,qBAKKF,MAAM,CAACI,MAAP,CACD,SAAAE,KAAK,0CACH,iBAAAA,KAAK,CAACC,MAAN,wDAAcd,WAAd,GAA4Be,UAA5B,CAAuC5B,WAAW,CAACa,WAAZ,GAA0BC,IAA1B,EAAvC,IACA,iBAAAY,KAAK,CAACC,MAAN,wDAAcd,WAAd,MAAgCS,WAAW,CAAC,CAAD,CAFxC,EADJ,CALL,qBAYKF,MAAM,CAACI,MAAP,CACD,SAAAE,KAAK,0CACH,kBAACA,KAAK,CAACC,MAAP,yCAAC,eAAcd,WAAd,GAA4Be,UAA5B,CAAuC5B,WAAW,CAACa,WAAZ,GAA0BC,IAA1B,EAAvC,CAAD,GACA,iBAAAY,KAAK,CAACC,MAAN,wDAAcd,WAAd,MAAgCS,WAAW,CAAC,CAAD,CAFxC,EADJ,CAZL,GAkBD,CA7B4C,CA6B1C,CAACN,cAAD,CAAiBhB,WAAjB,CAA8Be,eAA9B,CA7B0C,CAA7C,CA+BA,GAAMc,CAAAA,oBAAoB,CAAGrF,WAAW,CACtC,SAACsF,QAAD,CAAwB,CACtBzC,gBAAgB,CAACyC,QAAD,CAAhB,CACAtC,SAAS,GACV,CAJqC,CAKtC,CAACA,SAAD,CAAYH,gBAAZ,CALsC,CAAxC,CAQA;AACA5C,SAAS,CAAC,UAAM,CACd,GAAIgD,MAAJ,CAAYQ,cAAc,CAAC,EAAD,CAAd,CACb,CAFQ,CAEN,CAACR,MAAD,CAFM,CAAT,CAIA;AACA,GAAMsC,CAAAA,QAAQ,CAAGpF,MAAM,EAAvB,CACA,GAAMqF,CAAAA,WAAW,CAAGxF,WAAW,CAAC,SAAA+D,KAAK,CAAI,wBACvC,GAAM0B,CAAAA,KAAK,CAAG1B,KAAK,CAAC2B,MAAN,CAAaC,KAA3B,CACA,GAAMC,CAAAA,gBAAgB,CAAG3E,SAAS,CAACwE,KAAD,CAAlC,CACAhC,cAAc,CAACmC,gBAAgB,EAAIH,KAArB,CAAd,CACA,oBAAAlC,SAAS,CAACsC,OAAV,gEAAmBC,QAAnB,CAA4B,CAA5B,EACD,CAL8B,CAK5B,EAL4B,CAA/B,CAOA,GAAMC,CAAAA,WAAW,CAAG/F,WAAW,CAC7B,SAACgG,CAAD,CAAwC,CACtC,GAAIA,CAAC,CAACC,GAAF,GAAU,OAAd,CAAuB,CACrB,GAAM7B,CAAAA,CAAC,CAAGZ,WAAW,CAACa,WAAZ,GAA0BC,IAA1B,EAAV,CACA,GAAIF,CAAC,GAAK,KAAV,CAAiB,CACfiB,oBAAoB,CAACvF,KAAD,CAApB,CACD,CAFD,IAEO,IAAI6E,oBAAoB,CAACM,MAArB,CAA8B,CAAlC,CAAqC,2BAC1C,GACE,wBAAAN,oBAAoB,CAAC,CAAD,CAApB,CAAwBQ,MAAxB,sEAAgCd,WAAhC,MAAkDb,WAAW,CAACc,IAAZ,GAAmBD,WAAnB,EAAlD,EACAM,oBAAoB,CAACM,MAArB,GAAgC,CAFlC,CAGE,CACAI,oBAAoB,CAACV,oBAAoB,CAAC,CAAD,CAArB,CAApB,CACD,CACF,CACF,CACF,CAf4B,CAgB7B,CAACA,oBAAD,CAAuBU,oBAAvB,CAA6C7B,WAA7C,CAhB6B,CAA/B,CAmBA;AAhHsB,eAiHCzB,SAAS,CAAC,KAAD,CAjHV,0CAiHfmE,IAjHe,gBAiHTC,MAjHS,gBAkHtB,GAAMC,CAAAA,IAAI,CAAGjG,MAAM,EAAnB,CACA6B,iBAAiB,CAACoE,IAAD,CAAOF,IAAI,CAAGC,MAAH,CAAYE,SAAvB,CAAjB,CAEA;AArHsB,eAsHkBjG,QAAQ,CAAC,KAAD,CAtH1B,yCAsHfkG,YAtHe,eAsHDC,eAtHC,eAuHtB,GAAMC,CAAAA,cAAc,CAAG5F,sBAAsB,CAAC4C,WAAD,CAA7C,CAEA;AACAvD,SAAS,CAAC,UAAM,CACd,GAAIuD,WAAW,GAAK,EAApB,CAAwB,CACtB+C,eAAe,CAAC,KAAD,CAAf,CACD,CACF,CAJQ,CAIN,CAACA,eAAD,CAAkB/C,WAAlB,CAJM,CAAT,CAMA,mBACE,oBAAC,cAAD,mBACE,oBAAC,YAAD,EAAc,GAAG,CAAC,MAAlB,eACE,oBAAC,UAAD,mBACE,oBAAC,IAAD,EAAM,UAAU,CAAE,GAAlB,CAAuB,QAAQ,CAAE,EAAjC,mBADF,cAIE,oBAAC,SAAD,EAAW,OAAO,CAAER,SAApB,EAJF,CADF,cAOE,oBAAC,GAAD,mBACE,oBAAC,WAAD,EACE,IAAI,CAAC,MADP,CAEE,EAAE,CAAC,oBAFL,CAGE,WAAW,CAAEK,CAAC,CAAC,wBAAD,CAHhB,CAIE,YAAY,CAAC,KAJf,CAKE,KAAK,CAAEG,WALT,CAME,GAAG,CAAE+B,QANP,CAOE,QAAQ,CAAEC,WAPZ,CAQE,SAAS,CAAEO,WARb,EADF,CAPF,CAmBGhD,eAAe,eACd,oBAAC,WAAD,EAAa,OAAO,CAAEO,OAAtB,CAA+B,QAAQ,CAAE+B,oBAAzC,CAA+D,gBAAgB,CAAEzC,gBAAjF,EApBJ,CADF,cAwBE,oBAAC,SAAD,MAxBF,CAyBGiB,WAAW,EAAI,CAACC,kBAAhB,cACC,oBAAC,MAAD,EAAQ,KAAK,CAAE,CAAE2C,OAAO,CAAE,QAAX,CAAqBC,MAAM,CAAE,MAA7B,CAAf,eACE,oBAAC,SAAD,EAAW,KAAK,CAAE7C,WAAlB,CAA+B,cAAc,CAAEV,cAA/C,CAA+D,cAAc,CAAEC,cAA/E,EADF,CADD,CAIG,CAAAuB,oBAAoB,OAApB,EAAAA,oBAAoB,SAApB,QAAAA,oBAAoB,CAAEM,MAAtB,EAA+B,CAA/B,EAAqCqB,YAAY,EAAIE,cAAhB,EAAkCA,cAAc,CAACvB,MAAf,CAAwB,CAA/F,cACF,2BAAK,KAAK,CAAE,CAAE0B,IAAI,CAAE,GAAR,CAAZ,eACE,oBAAC,SAAD,EAAW,YAAY,KAAvB,EACG,mBAAGD,CAAAA,MAAH,OAAGA,MAAH,oBACC,oBAAC,YAAD,EACE,MAAM,CAAEA,MADV,CAEE,OAAO,CAAEvC,OAFX,CAGE,UAAU,CACRmC,YAAY,EAAIE,cAAhB,CAAiC7B,oBAAoB,CAACiC,MAArB,CAA4BJ,cAA5B,CAAjC,CAA+E7B,oBAJnF,CAME,gBAAgB,CAAEU,oBANpB,CAOE,aAAa,CAAEvC,qBAPjB,CAQE,gBAAgB,CAAEF,gBARpB,CASE,YAAY,CAAEW,SAThB,CAUE,cAAc,CAAEJ,cAVlB,CAWE,cAAc,CAAEC,cAXlB,EADD,EADH,CADF,CADE,cAqBF,oBAAC,MAAD,EAAQ,KAAK,CAAE,CAAEqD,OAAO,CAAE,MAAX,CAAmBC,MAAM,CAAE,MAA3B,CAAf,eACE,oBAAC,IAAD,CAAM,IAAN,EAAW,KAAK,CAAElE,KAAK,CAACqE,KAAxB,CAA+B,SAAS,CAAC,QAAzC,CAAkD,EAAE,CAAC,MAArD,sCADF,CAIGL,cAAc,EACbA,cAAc,CAACvB,MAAf,CAAwB,CADzB,EAEC,EAAEpB,WAAW,EAAI,CAACC,kBAAlB,CAFD,EAGCN,WAAW,CAACyB,MAAZ,CAAqB,CAHtB,EAIC,CAAAN,oBAAoB,OAApB,EAAAA,oBAAoB,SAApB,QAAAA,oBAAoB,CAAEM,MAAtB,IAAiC,CAJlC,gBAKG;AACA,oBAAC,GAAD,EAAK,KAAK,CAAC,QAAX,CAAoB,KAAK,CAAC,MAA1B,CAAiC,OAAO,CAAC,QAAzC,eACE,oBAAC,WAAD,EACE,KAAK,CAAC,aADR,CAEE,YAAY,CAAC,MAFf,CAGE,OAAO,CAAC,UAHV,CAIE,OAAO,CAAE,yBAAMsB,CAAAA,eAAe,CAAC,CAACD,YAAF,CAArB,EAJX,EAMG,CAACA,YAAD,gBACWE,cAAc,CAACvB,MAD1B,2BACkDuB,cAAc,CAACvB,MAAf,GAA0B,CAA1B,CAA8B,OAA9B,CAAwC,QAD1F,EAEG,sBARN,CADF,CAVN,CAlDJ,CA4EGuB,cAAc,EACbA,cAAc,CAACvB,MAAf,CAAwB,CADzB,EAEC,EAAEpB,WAAW,EAAI,CAACC,kBAAlB,CAFD,GAGEN,WAAW,CAACyB,MAAZ,CAAqB,CAArB,EAA0BqB,YAH5B,IAIE,CAAA3B,oBAAoB,OAApB,EAAAA,oBAAoB,SAApB,QAAAA,oBAAoB,CAAEM,MAAtB,IAAiC,CAAjC,EAAsCqB,YAJxC,iBAKG;AACA,oBAAC,GAAD,EAAK,KAAK,CAAC,QAAX,CAAoB,KAAK,CAAC,MAA1B,CAAiC,OAAO,CAAC,QAAzC,CAAkD,KAAK,CAAE,CAAEQ,QAAQ,CAAE,UAAZ,CAAwBC,MAAM,CAAE,MAAhC,CAAwCC,IAAI,CAAE,CAA9C,CAAzD,eACE,oBAAC,WAAD,EACE,KAAK,CAAC,aADR,CAEE,YAAY,CAAC,MAFf,CAGE,OAAO,CAAC,UAHV,CAIE,OAAO,CAAE,yBAAMT,CAAAA,eAAe,CAAC,CAACD,YAAF,CAArB,EAJX,EAMG,CAACA,YAAD,gBACWE,cAAc,CAACvB,MAD1B,2BACkDuB,cAAc,CAACvB,MAAf,GAA0B,CAA1B,CAA8B,OAA9B,CAAwC,QAD1F,EAEG,sBARN,CADF,CAlFN,cA+FE,oBAAC,MAAD,mBACE,oBAAC,GAAD,EAAK,OAAO,CAAC,QAAb,eACE,oBAAC,UAAD,EAAY,OAAO,CAAE/B,cAArB,CAAqC,KAAK,CAAEV,KAAK,CAACyE,KAAlD,CAAyD,SAAS,CAAC,0BAAnE,eACE,oBAAC,QAAD,mBACE,oBAAC,WAAD,EAAa,IAAI,CAAC,MAAlB,CAAyB,WAAW,CAAC,KAArC,eACE,oBAAC,IAAD,MADF,CADF,cAIE,oBAAC,IAAD,CAAM,IAAN,EAAW,KAAK,CAAEzE,KAAK,CAACyE,KAAxB,WAJF,CADF,CADF,CADF,CA/FF,CADF,CA8GD","sourcesContent":["import { Currency, ETHER, Token } from '@uniswap/sdk'\nimport React, { KeyboardEvent, RefObject, useCallback, useEffect, useMemo, useRef, useState } from 'react'\nimport ReactGA from 'react-ga'\nimport { useTranslation } from 'react-i18next'\nimport { FixedSizeList } from 'react-window'\nimport { Text } from 'rebass'\nimport { useActiveWeb3React } from '../../hooks'\nimport { useAllTokens, useToken, useIsUserAddedToken, useFoundOnInactiveList } from '../../hooks/Tokens'\nimport { CloseIcon, TYPE, ButtonText, IconWrapper } from '../../theme'\nimport { isAddress } from '../../utils'\nimport Column from '../Column'\nimport Row, { RowBetween, RowFixed } from '../Row'\nimport CommonBases from './CommonBases'\nimport CurrencyList from './CurrencyList'\nimport { filterTokens } from './filtering'\nimport { useTokenComparator } from './sorting'\nimport { PaddedColumn, SearchInput, Separator } from './styleds'\nimport AutoSizer from 'react-virtualized-auto-sizer'\nimport styled from 'styled-components'\nimport useToggle from 'hooks/useToggle'\nimport { useOnClickOutside } from 'hooks/useOnClickOutside'\nimport useTheme from 'hooks/useTheme'\nimport ImportRow from './ImportRow'\nimport { Edit } from 'react-feather'\nimport { ButtonLight } from 'components/Button'\n\nconst ContentWrapper = styled(Column)`\n  width: 100%;\n  flex: 1 1;\n  position: relative;\n`\n\nconst Footer = styled.div`\n  width: 100%;\n  border-radius: 20px;\n  padding: 20px;\n  border-top-left-radius: 0;\n  border-top-right-radius: 0;\n  background-color: ${({ theme }) => theme.bg1};\n  border-top: 1px solid ${({ theme }) => theme.bg2};\n`\n\ninterface CurrencySearchProps {\n  isOpen: boolean\n  onDismiss: () => void\n  selectedCurrency?: Currency | null\n  onCurrencySelect: (currency: Currency) => void\n  otherSelectedCurrency?: Currency | null\n  showCommonBases?: boolean\n  showManageView: () => void\n  showImportView: () => void\n  setImportToken: (token: Token) => void\n}\n\nexport function CurrencySearch({\n  selectedCurrency,\n  onCurrencySelect,\n  otherSelectedCurrency,\n  showCommonBases,\n  onDismiss,\n  isOpen,\n  showManageView,\n  showImportView,\n  setImportToken\n}: CurrencySearchProps) {\n  const { t } = useTranslation()\n  const { chainId } = useActiveWeb3React()\n  const theme = useTheme()\n\n  // refs for fixed size lists\n  const fixedList = useRef<FixedSizeList>()\n\n  const [searchQuery, setSearchQuery] = useState<string>('')\n  const [invertSearchOrder] = useState<boolean>(false)\n\n  const allTokens = useAllTokens()\n  // const inactiveTokens: Token[] | undefined = useFoundOnInactiveList(searchQuery)\n\n  // if they input an address, use it\n  const isAddressSearch = isAddress(searchQuery)\n  const searchToken = useToken(searchQuery)\n  const searchTokenIsAdded = useIsUserAddedToken(searchToken)\n\n  useEffect(() => {\n    if (isAddressSearch) {\n      ReactGA.event({\n        category: 'Currency Select',\n        action: 'Search by address',\n        label: isAddressSearch\n      })\n    }\n  }, [isAddressSearch])\n\n  const showETH: boolean = useMemo(() => {\n    const s = searchQuery.toLowerCase().trim()\n    return s === '' || s === 'e' || s === 'et' || s === 'eth'\n  }, [searchQuery])\n\n  const tokenComparator = useTokenComparator(invertSearchOrder)\n\n  const filteredTokens: Token[] = useMemo(() => {\n    return filterTokens(Object.values(allTokens), searchQuery)\n  }, [allTokens, searchQuery])\n\n  const filteredSortedTokens: Token[] = useMemo(() => {\n    const sorted = filteredTokens.sort(tokenComparator)\n    const symbolMatch = searchQuery\n      .toLowerCase()\n      .split(/\\s+/)\n      .filter(s => s.length > 0)\n\n    if (symbolMatch.length > 1) {\n      return sorted\n    }\n\n    return [\n      // sort any exact symbol matches first\n      ...sorted.filter(token => token.symbol?.toLowerCase() === symbolMatch[0]),\n\n      // sort by tokens whos symbols start with search substrng\n      ...sorted.filter(\n        token =>\n          token.symbol?.toLowerCase().startsWith(searchQuery.toLowerCase().trim()) &&\n          token.symbol?.toLowerCase() !== symbolMatch[0]\n      ),\n\n      // rest that dont match upove\n      ...sorted.filter(\n        token =>\n          !token.symbol?.toLowerCase().startsWith(searchQuery.toLowerCase().trim()) &&\n          token.symbol?.toLowerCase() !== symbolMatch[0]\n      )\n    ]\n  }, [filteredTokens, searchQuery, tokenComparator])\n\n  const handleCurrencySelect = useCallback(\n    (currency: Currency) => {\n      onCurrencySelect(currency)\n      onDismiss()\n    },\n    [onDismiss, onCurrencySelect]\n  )\n\n  // clear the input on open\n  useEffect(() => {\n    if (isOpen) setSearchQuery('')\n  }, [isOpen])\n\n  // manage focus on modal show\n  const inputRef = useRef<HTMLInputElement>()\n  const handleInput = useCallback(event => {\n    const input = event.target.value\n    const checksummedInput = isAddress(input)\n    setSearchQuery(checksummedInput || input)\n    fixedList.current?.scrollTo(0)\n  }, [])\n\n  const handleEnter = useCallback(\n    (e: KeyboardEvent<HTMLInputElement>) => {\n      if (e.key === 'Enter') {\n        const s = searchQuery.toLowerCase().trim()\n        if (s === 'eth') {\n          handleCurrencySelect(ETHER)\n        } else if (filteredSortedTokens.length > 0) {\n          if (\n            filteredSortedTokens[0].symbol?.toLowerCase() === searchQuery.trim().toLowerCase() ||\n            filteredSortedTokens.length === 1\n          ) {\n            handleCurrencySelect(filteredSortedTokens[0])\n          }\n        }\n      }\n    },\n    [filteredSortedTokens, handleCurrencySelect, searchQuery]\n  )\n\n  // menu ui\n  const [open, toggle] = useToggle(false)\n  const node = useRef<HTMLDivElement>()\n  useOnClickOutside(node, open ? toggle : undefined)\n\n  // if no results on main list, show option to expand into inactive\n  const [showExpanded, setShowExpanded] = useState(false)\n  const inactiveTokens = useFoundOnInactiveList(searchQuery)\n\n  // reset expanded results on query reset\n  useEffect(() => {\n    if (searchQuery === '') {\n      setShowExpanded(false)\n    }\n  }, [setShowExpanded, searchQuery])\n\n  return (\n    <ContentWrapper>\n      <PaddedColumn gap=\"16px\">\n        <RowBetween>\n          <Text fontWeight={500} fontSize={16}>\n            Select a token\n          </Text>\n          <CloseIcon onClick={onDismiss} />\n        </RowBetween>\n        <Row>\n          <SearchInput\n            type=\"text\"\n            id=\"token-search-input\"\n            placeholder={t('tokenSearchPlaceholder')}\n            autoComplete=\"off\"\n            value={searchQuery}\n            ref={inputRef as RefObject<HTMLInputElement>}\n            onChange={handleInput}\n            onKeyDown={handleEnter}\n          />\n        </Row>\n        {showCommonBases && (\n          <CommonBases chainId={chainId} onSelect={handleCurrencySelect} selectedCurrency={selectedCurrency} />\n        )}\n      </PaddedColumn>\n      <Separator />\n      {searchToken && !searchTokenIsAdded ? (\n        <Column style={{ padding: '20px 0', height: '100%' }}>\n          <ImportRow token={searchToken} showImportView={showImportView} setImportToken={setImportToken} />\n        </Column>\n      ) : filteredSortedTokens?.length > 0 || (showExpanded && inactiveTokens && inactiveTokens.length > 0) ? (\n        <div style={{ flex: '1' }}>\n          <AutoSizer disableWidth>\n            {({ height }) => (\n              <CurrencyList\n                height={height}\n                showETH={showETH}\n                currencies={\n                  showExpanded && inactiveTokens ? filteredSortedTokens.concat(inactiveTokens) : filteredSortedTokens\n                }\n                onCurrencySelect={handleCurrencySelect}\n                otherCurrency={otherSelectedCurrency}\n                selectedCurrency={selectedCurrency}\n                fixedListRef={fixedList}\n                showImportView={showImportView}\n                setImportToken={setImportToken}\n              />\n            )}\n          </AutoSizer>\n        </div>\n      ) : (\n        <Column style={{ padding: '20px', height: '100%' }}>\n          <TYPE.main color={theme.text3} textAlign=\"center\" mb=\"20px\">\n            No results found in active lists.\n          </TYPE.main>\n          {inactiveTokens &&\n            inactiveTokens.length > 0 &&\n            !(searchToken && !searchTokenIsAdded) &&\n            searchQuery.length > 1 &&\n            filteredSortedTokens?.length === 0 && (\n              // expand button in line with no results\n              <Row align=\"center\" width=\"100%\" justify=\"center\">\n                <ButtonLight\n                  width=\"fit-content\"\n                  borderRadius=\"12px\"\n                  padding=\"8px 12px\"\n                  onClick={() => setShowExpanded(!showExpanded)}\n                >\n                  {!showExpanded\n                    ? `Show ${inactiveTokens.length} more inactive ${inactiveTokens.length === 1 ? 'token' : 'tokens'}`\n                    : 'Hide expanded search'}\n                </ButtonLight>\n              </Row>\n            )}\n        </Column>\n      )}\n\n      {inactiveTokens &&\n        inactiveTokens.length > 0 &&\n        !(searchToken && !searchTokenIsAdded) &&\n        (searchQuery.length > 1 || showExpanded) &&\n        (filteredSortedTokens?.length !== 0 || showExpanded) && (\n          // button fixed to bottom\n          <Row align=\"center\" width=\"100%\" justify=\"center\" style={{ position: 'absolute', bottom: '80px', left: 0 }}>\n            <ButtonLight\n              width=\"fit-content\"\n              borderRadius=\"12px\"\n              padding=\"8px 12px\"\n              onClick={() => setShowExpanded(!showExpanded)}\n            >\n              {!showExpanded\n                ? `Show ${inactiveTokens.length} more inactive ${inactiveTokens.length === 1 ? 'token' : 'tokens'}`\n                : 'Hide expanded search'}\n            </ButtonLight>\n          </Row>\n        )}\n      <Footer>\n        <Row justify=\"center\">\n          <ButtonText onClick={showManageView} color={theme.blue1} className=\"list-token-manage-button\">\n            <RowFixed>\n              <IconWrapper size=\"16px\" marginRight=\"6px\">\n                <Edit />\n              </IconWrapper>\n              <TYPE.main color={theme.blue1}>Manage</TYPE.main>\n            </RowFixed>\n          </ButtonText>\n        </Row>\n      </Footer>\n    </ContentWrapper>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}