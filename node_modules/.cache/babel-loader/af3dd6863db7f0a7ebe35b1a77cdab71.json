{"ast":null,"code":"import _slicedToArray from\"/projects/testswap/uniswap-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/projects/testswap/uniswap-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject12(){var data=_taggedTemplateLiteral([\"\\n  word-break: break-all;\\n\"]);_templateObject12=function _templateObject12(){return data;};return data;}function _templateObject11(){var data=_taggedTemplateLiteral([\"\\n  word-break: break-all;\\n\"]);_templateObject11=function _templateObject11(){return data;};return data;}function _templateObject10(){var data=_taggedTemplateLiteral([\"\\n    align-items: flex-start;\\n    flex-direction: column;\\n  \"]);_templateObject10=function _templateObject10(){return data;};return data;}function _templateObject9(){var data=_taggedTemplateLiteral([\"\\n  \",\";\\n\"]);_templateObject9=function _templateObject9(){return data;};return data;}function _templateObject8(){var data=_taggedTemplateLiteral([\"\\n  max-width: 640px;\\n  overflow: hidden;\\n\"]);_templateObject8=function _templateObject8(){return data;};return data;}function _templateObject7(){var data=_taggedTemplateLiteral([\"\\n  height: 4px;\\n  border-radius: 4px;\\n  background-color: \",\";\\n  width: \",\";\\n\"]);_templateObject7=function _templateObject7(){return data;};return data;}function _templateObject6(){var data=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  margin-top: 1rem;\\n  height: 4px;\\n  border-radius: 4px;\\n  background-color: \",\";\\n  position: relative;\\n\"]);_templateObject6=function _templateObject6(){return data;};return data;}function _templateObject5(){var data=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  background: none;\\n  background-color: \",\";\\n  height: fit-content;\\n  z-index: 2;\\n\"]);_templateObject5=function _templateObject5(){return data;};return data;}function _templateObject4(){var data=_taggedTemplateLiteral([\"\\n  display: grid;\\n  grid-template-columns: 1fr 1fr;\\n  gap: 12px;\\n  width: 100%;\\n\"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  gap: 8px;\\n  height: 24px;\\n  color: \",\";\\n\\n  a {\\n    color: \",\";\\n    text-decoration: none;\\n  }\\n  :hover {\\n    text-decoration: none;\\n  }\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  border: 1px solid \",\";\\n  border-radius: 12px;\\n  padding: 1.5rem;\\n  position: relative;\\n  max-width: 640px;\\n  width: 100%;\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  width: 100%;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useState}from'react';import{AutoColumn}from'../../components/Column';import styled from'styled-components';import{TYPE,StyledInternalLink,ExternalLink}from'../../theme';import{RowFixed,RowBetween}from'../../components/Row';import{CardSection,DataCard}from'../../components/earn/styled';import{ArrowLeft}from'react-feather';import{ButtonPrimary}from'../../components/Button';import{ProposalStatus}from'./styled';import{useProposalData,useUserVotesAsOfBlock,useUserDelegatee}from'../../state/governance/hooks';import{DateTime}from'luxon';import ReactMarkdown from'react-markdown';import VoteModal from'../../components/vote/VoteModal';import{JSBI}from'@uniswap/sdk';import{useActiveWeb3React}from'../../hooks';import{AVERAGE_BLOCK_TIME_IN_SECS,COMMON_CONTRACT_NAMES,UNI,ZERO_ADDRESS}from'../../constants';import{isAddress,getEtherscanLink}from'../../utils';import{ApplicationModal}from'../../state/application/actions';import{useModalOpen,useToggleDelegateModal,useToggleVoteModal,useBlockNumber}from'../../state/application/hooks';import DelegateModal from'../../components/vote/DelegateModal';import{GreyCard}from'../../components/Card';import{useTokenBalance}from'../../state/wallet/hooks';import useCurrentBlockTimestamp from'hooks/useCurrentBlockTimestamp';import{BigNumber}from'ethers';var PageWrapper=styled(AutoColumn)(_templateObject());var ProposalInfo=styled(AutoColumn)(_templateObject2(),function(_ref){var theme=_ref.theme;return theme.bg4;});var ArrowWrapper=styled(StyledInternalLink)(_templateObject3(),function(_ref2){var theme=_ref2.theme;return theme.text1;},function(_ref3){var theme=_ref3.theme;return theme.text1;});var CardWrapper=styled.div(_templateObject4());var StyledDataCard=styled(DataCard)(_templateObject5(),function(_ref4){var theme=_ref4.theme;return theme.bg1;});var ProgressWrapper=styled.div(_templateObject6(),function(_ref5){var theme=_ref5.theme;return theme.bg3;});var Progress=styled.div(_templateObject7(),function(_ref6){var theme=_ref6.theme,status=_ref6.status;return status==='for'?theme.green1:theme.red1;},function(_ref7){var percentageString=_ref7.percentageString;return percentageString;});var MarkDownWrapper=styled.div(_templateObject8());var WrapSmall=styled(RowBetween)(_templateObject9(),function(_ref8){var theme=_ref8.theme;return theme.mediaWidth.upToSmall(_templateObject10());});var DetailText=styled.div(_templateObject11());var ProposerAddressLink=styled(ExternalLink)(_templateObject12());export default function VotePage(_ref9){var _proposalData$startBl,_proposalData$status,_proposalData$details;var id=_ref9.match.params.id;var _useActiveWeb3React=useActiveWeb3React(),chainId=_useActiveWeb3React.chainId,account=_useActiveWeb3React.account;// get data for this specific proposal\nvar proposalData=useProposalData(id);// update support based on button interactions\nvar _useState=useState(true),_useState2=_slicedToArray(_useState,2),support=_useState2[0],setSupport=_useState2[1];// modal for casting votes\nvar showVoteModal=useModalOpen(ApplicationModal.VOTE);var toggleVoteModal=useToggleVoteModal();// toggle for showing delegation modal\nvar showDelegateModal=useModalOpen(ApplicationModal.DELEGATE);var toggleDelegateModal=useToggleDelegateModal();// get and format date from data\nvar currentTimestamp=useCurrentBlockTimestamp();var currentBlock=useBlockNumber();var endDate=proposalData&&currentTimestamp&&currentBlock?DateTime.fromSeconds(currentTimestamp.add(BigNumber.from(AVERAGE_BLOCK_TIME_IN_SECS).mul(BigNumber.from(proposalData.endBlock-currentBlock))).toNumber()):undefined;var now=DateTime.local();// get total votes and format percentages for UI\nvar totalVotes=proposalData?proposalData.forCount+proposalData.againstCount:undefined;var forPercentage=proposalData&&totalVotes?(proposalData.forCount*100/totalVotes).toFixed(0)+'%':'0%';var againstPercentage=proposalData&&totalVotes?(proposalData.againstCount*100/totalVotes).toFixed(0)+'%':'0%';// only count available votes as of the proposal start block\nvar availableVotes=useUserVotesAsOfBlock((_proposalData$startBl=proposalData===null||proposalData===void 0?void 0:proposalData.startBlock)!==null&&_proposalData$startBl!==void 0?_proposalData$startBl:undefined);// only show voting if user has > 0 votes at proposal start block and proposal is active,\nvar showVotingButtons=availableVotes&&JSBI.greaterThan(availableVotes.raw,JSBI.BigInt(0))&&proposalData&&proposalData.status==='active';var uniBalance=useTokenBalance(account!==null&&account!==void 0?account:undefined,chainId?UNI[chainId]:undefined);var userDelegatee=useUserDelegatee();// in blurb link to home page if they are able to unlock\nvar showLinkForUnlock=Boolean(uniBalance&&JSBI.notEqual(uniBalance.raw,JSBI.BigInt(0))&&userDelegatee===ZERO_ADDRESS);// show links in propsoal details if content is an address\n// if content is contract with common name, replace address with common name\nvar linkIfAddress=function linkIfAddress(content){if(isAddress(content)&&chainId){var _COMMON_CONTRACT_NAME;var commonName=(_COMMON_CONTRACT_NAME=COMMON_CONTRACT_NAMES[content])!==null&&_COMMON_CONTRACT_NAME!==void 0?_COMMON_CONTRACT_NAME:content;return/*#__PURE__*/React.createElement(ExternalLink,{href:getEtherscanLink(chainId,content,'address')},commonName);}return/*#__PURE__*/React.createElement(\"span\",null,content);};return/*#__PURE__*/React.createElement(PageWrapper,{gap:\"lg\",justify:\"center\"},/*#__PURE__*/React.createElement(VoteModal,{isOpen:showVoteModal,onDismiss:toggleVoteModal,proposalId:proposalData===null||proposalData===void 0?void 0:proposalData.id,support:support}),/*#__PURE__*/React.createElement(DelegateModal,{isOpen:showDelegateModal,onDismiss:toggleDelegateModal,title:\"Unlock Votes\"}),/*#__PURE__*/React.createElement(ProposalInfo,{gap:\"lg\",justify:\"start\"},/*#__PURE__*/React.createElement(RowBetween,{style:{width:'100%'}},/*#__PURE__*/React.createElement(ArrowWrapper,{to:\"/vote\"},/*#__PURE__*/React.createElement(ArrowLeft,{size:20}),\" All Proposals\"),proposalData&&/*#__PURE__*/React.createElement(ProposalStatus,{status:(_proposalData$status=proposalData===null||proposalData===void 0?void 0:proposalData.status)!==null&&_proposalData$status!==void 0?_proposalData$status:''},proposalData===null||proposalData===void 0?void 0:proposalData.status)),/*#__PURE__*/React.createElement(AutoColumn,{gap:\"10px\",style:{width:'100%'}},/*#__PURE__*/React.createElement(TYPE.largeHeader,{style:{marginBottom:'.5rem'}},proposalData===null||proposalData===void 0?void 0:proposalData.title),/*#__PURE__*/React.createElement(RowBetween,null,/*#__PURE__*/React.createElement(TYPE.main,null,endDate&&endDate<now?'Voting ended '+(endDate&&endDate.toLocaleString(DateTime.DATETIME_FULL)):proposalData?'Voting ends approximately '+(endDate&&endDate.toLocaleString(DateTime.DATETIME_FULL)):'')),proposalData&&proposalData.status==='active'&&!showVotingButtons&&/*#__PURE__*/React.createElement(GreyCard,null,/*#__PURE__*/React.createElement(TYPE.black,null,\"Only UNI votes that were self delegated or delegated to another address before block\",' ',proposalData.startBlock,\" are eligible for voting.\",' ',showLinkForUnlock&&/*#__PURE__*/React.createElement(\"span\",null,/*#__PURE__*/React.createElement(StyledInternalLink,{to:\"/vote\"},\"Unlock voting\"),\" to prepare for the next proposal.\")))),showVotingButtons?/*#__PURE__*/React.createElement(RowFixed,{style:{width:'100%',gap:'12px'}},/*#__PURE__*/React.createElement(ButtonPrimary,{padding:\"8px\",borderRadius:\"8px\",onClick:function onClick(){setSupport(true);toggleVoteModal();}},\"Vote For\"),/*#__PURE__*/React.createElement(ButtonPrimary,{padding:\"8px\",borderRadius:\"8px\",onClick:function onClick(){setSupport(false);toggleVoteModal();}},\"Vote Against\")):'',/*#__PURE__*/React.createElement(CardWrapper,null,/*#__PURE__*/React.createElement(StyledDataCard,null,/*#__PURE__*/React.createElement(CardSection,null,/*#__PURE__*/React.createElement(AutoColumn,{gap:\"md\"},/*#__PURE__*/React.createElement(WrapSmall,null,/*#__PURE__*/React.createElement(TYPE.black,{fontWeight:600},\"For\"),/*#__PURE__*/React.createElement(TYPE.black,{fontWeight:600},' ',proposalData===null||proposalData===void 0?void 0:proposalData.forCount.toLocaleString(undefined,{maximumFractionDigits:0})))),/*#__PURE__*/React.createElement(ProgressWrapper,null,/*#__PURE__*/React.createElement(Progress,{status:'for',percentageString:forPercentage})))),/*#__PURE__*/React.createElement(StyledDataCard,null,/*#__PURE__*/React.createElement(CardSection,null,/*#__PURE__*/React.createElement(AutoColumn,{gap:\"md\"},/*#__PURE__*/React.createElement(WrapSmall,null,/*#__PURE__*/React.createElement(TYPE.black,{fontWeight:600},\"Against\"),/*#__PURE__*/React.createElement(TYPE.black,{fontWeight:600},proposalData===null||proposalData===void 0?void 0:proposalData.againstCount.toLocaleString(undefined,{maximumFractionDigits:0})))),/*#__PURE__*/React.createElement(ProgressWrapper,null,/*#__PURE__*/React.createElement(Progress,{status:'against',percentageString:againstPercentage}))))),/*#__PURE__*/React.createElement(AutoColumn,{gap:\"md\"},/*#__PURE__*/React.createElement(TYPE.mediumHeader,{fontWeight:600},\"Details\"),proposalData===null||proposalData===void 0?void 0:(_proposalData$details=proposalData.details)===null||_proposalData$details===void 0?void 0:_proposalData$details.map(function(d,i){return/*#__PURE__*/React.createElement(DetailText,{key:i},i+1,\": \",linkIfAddress(d.target),\".\",d.functionSig,\"(\",d.callData.split(',').map(function(content,i){return/*#__PURE__*/React.createElement(\"span\",{key:i},linkIfAddress(content),d.callData.split(',').length-1===i?'':',');}),\")\");})),/*#__PURE__*/React.createElement(AutoColumn,{gap:\"md\"},/*#__PURE__*/React.createElement(TYPE.mediumHeader,{fontWeight:600},\"Description\"),/*#__PURE__*/React.createElement(MarkDownWrapper,null,/*#__PURE__*/React.createElement(ReactMarkdown,{source:proposalData===null||proposalData===void 0?void 0:proposalData.description}))),/*#__PURE__*/React.createElement(AutoColumn,{gap:\"md\"},/*#__PURE__*/React.createElement(TYPE.mediumHeader,{fontWeight:600},\"Proposer\"),/*#__PURE__*/React.createElement(ProposerAddressLink,{href:(proposalData===null||proposalData===void 0?void 0:proposalData.proposer)&&chainId?getEtherscanLink(chainId,proposalData===null||proposalData===void 0?void 0:proposalData.proposer,'address'):''},/*#__PURE__*/React.createElement(ReactMarkdown,{source:proposalData===null||proposalData===void 0?void 0:proposalData.proposer})))));}","map":{"version":3,"sources":["/projects/testswap/uniswap-interface/src/pages/Vote/VotePage.tsx"],"names":["React","useState","AutoColumn","styled","TYPE","StyledInternalLink","ExternalLink","RowFixed","RowBetween","CardSection","DataCard","ArrowLeft","ButtonPrimary","ProposalStatus","useProposalData","useUserVotesAsOfBlock","useUserDelegatee","DateTime","ReactMarkdown","VoteModal","JSBI","useActiveWeb3React","AVERAGE_BLOCK_TIME_IN_SECS","COMMON_CONTRACT_NAMES","UNI","ZERO_ADDRESS","isAddress","getEtherscanLink","ApplicationModal","useModalOpen","useToggleDelegateModal","useToggleVoteModal","useBlockNumber","DelegateModal","GreyCard","useTokenBalance","useCurrentBlockTimestamp","BigNumber","PageWrapper","ProposalInfo","theme","bg4","ArrowWrapper","text1","CardWrapper","div","StyledDataCard","bg1","ProgressWrapper","bg3","Progress","status","green1","red1","percentageString","MarkDownWrapper","WrapSmall","mediaWidth","upToSmall","DetailText","ProposerAddressLink","VotePage","id","match","params","chainId","account","proposalData","support","setSupport","showVoteModal","VOTE","toggleVoteModal","showDelegateModal","DELEGATE","toggleDelegateModal","currentTimestamp","currentBlock","endDate","fromSeconds","add","from","mul","endBlock","toNumber","undefined","now","local","totalVotes","forCount","againstCount","forPercentage","toFixed","againstPercentage","availableVotes","startBlock","showVotingButtons","greaterThan","raw","BigInt","uniBalance","userDelegatee","showLinkForUnlock","Boolean","notEqual","linkIfAddress","content","commonName","width","marginBottom","title","toLocaleString","DATETIME_FULL","gap","maximumFractionDigits","details","map","d","i","target","functionSig","callData","split","length","description","proposer"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport { AutoColumn } from '../../components/Column'\nimport styled from 'styled-components'\n\nimport { RouteComponentProps } from 'react-router-dom'\nimport { TYPE, StyledInternalLink, ExternalLink } from '../../theme'\nimport { RowFixed, RowBetween } from '../../components/Row'\nimport { CardSection, DataCard } from '../../components/earn/styled'\nimport { ArrowLeft } from 'react-feather'\nimport { ButtonPrimary } from '../../components/Button'\nimport { ProposalStatus } from './styled'\nimport { useProposalData, useUserVotesAsOfBlock, ProposalData, useUserDelegatee } from '../../state/governance/hooks'\nimport { DateTime } from 'luxon'\nimport ReactMarkdown from 'react-markdown'\nimport VoteModal from '../../components/vote/VoteModal'\nimport { TokenAmount, JSBI } from '@uniswap/sdk'\nimport { useActiveWeb3React } from '../../hooks'\nimport { AVERAGE_BLOCK_TIME_IN_SECS, COMMON_CONTRACT_NAMES, UNI, ZERO_ADDRESS } from '../../constants'\nimport { isAddress, getEtherscanLink } from '../../utils'\nimport { ApplicationModal } from '../../state/application/actions'\nimport { useModalOpen, useToggleDelegateModal, useToggleVoteModal, useBlockNumber } from '../../state/application/hooks'\nimport DelegateModal from '../../components/vote/DelegateModal'\nimport { GreyCard } from '../../components/Card'\nimport { useTokenBalance } from '../../state/wallet/hooks'\nimport useCurrentBlockTimestamp from 'hooks/useCurrentBlockTimestamp'\nimport { BigNumber } from 'ethers'\n\nconst PageWrapper = styled(AutoColumn)`\n  width: 100%;\n`\n\nconst ProposalInfo = styled(AutoColumn)`\n  border: 1px solid ${({ theme }) => theme.bg4};\n  border-radius: 12px;\n  padding: 1.5rem;\n  position: relative;\n  max-width: 640px;\n  width: 100%;\n`\nconst ArrowWrapper = styled(StyledInternalLink)`\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  height: 24px;\n  color: ${({ theme }) => theme.text1};\n\n  a {\n    color: ${({ theme }) => theme.text1};\n    text-decoration: none;\n  }\n  :hover {\n    text-decoration: none;\n  }\n`\nconst CardWrapper = styled.div`\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 12px;\n  width: 100%;\n`\n\nconst StyledDataCard = styled(DataCard)`\n  width: 100%;\n  background: none;\n  background-color: ${({ theme }) => theme.bg1};\n  height: fit-content;\n  z-index: 2;\n`\n\nconst ProgressWrapper = styled.div`\n  width: 100%;\n  margin-top: 1rem;\n  height: 4px;\n  border-radius: 4px;\n  background-color: ${({ theme }) => theme.bg3};\n  position: relative;\n`\n\nconst Progress = styled.div<{ status: 'for' | 'against'; percentageString?: string }>`\n  height: 4px;\n  border-radius: 4px;\n  background-color: ${({ theme, status }) => (status === 'for' ? theme.green1 : theme.red1)};\n  width: ${({ percentageString }) => percentageString};\n`\n\nconst MarkDownWrapper = styled.div`\n  max-width: 640px;\n  overflow: hidden;\n`\n\nconst WrapSmall = styled(RowBetween)`\n  ${({ theme }) => theme.mediaWidth.upToSmall`\n    align-items: flex-start;\n    flex-direction: column;\n  `};\n`\n\nconst DetailText = styled.div`\n  word-break: break-all;\n`\n\nconst ProposerAddressLink = styled(ExternalLink)`\n  word-break: break-all;\n`\n\nexport default function VotePage({\n  match: {\n    params: { id }\n  }\n}: RouteComponentProps<{ id: string }>) {\n  const { chainId, account } = useActiveWeb3React()\n\n  // get data for this specific proposal\n  const proposalData: ProposalData | undefined = useProposalData(id)\n\n  // update support based on button interactions\n  const [support, setSupport] = useState<boolean>(true)\n\n  // modal for casting votes\n  const showVoteModal = useModalOpen(ApplicationModal.VOTE)\n  const toggleVoteModal = useToggleVoteModal()\n\n  // toggle for showing delegation modal\n  const showDelegateModal = useModalOpen(ApplicationModal.DELEGATE)\n  const toggleDelegateModal = useToggleDelegateModal()\n\n  // get and format date from data\n  const currentTimestamp = useCurrentBlockTimestamp()\n  const currentBlock = useBlockNumber()\n  const endDate: DateTime | undefined =\n    proposalData && currentTimestamp && currentBlock\n      ? DateTime.fromSeconds(\n          currentTimestamp\n            .add(BigNumber.from(AVERAGE_BLOCK_TIME_IN_SECS).mul(BigNumber.from(proposalData.endBlock - currentBlock)))\n            .toNumber()\n        )\n      : undefined\n  const now: DateTime = DateTime.local()\n\n  // get total votes and format percentages for UI\n  const totalVotes: number | undefined = proposalData ? proposalData.forCount + proposalData.againstCount : undefined\n  const forPercentage: string =\n    proposalData && totalVotes ? ((proposalData.forCount * 100) / totalVotes).toFixed(0) + '%' : '0%'\n  const againstPercentage: string =\n    proposalData && totalVotes ? ((proposalData.againstCount * 100) / totalVotes).toFixed(0) + '%' : '0%'\n\n  // only count available votes as of the proposal start block\n  const availableVotes: TokenAmount | undefined = useUserVotesAsOfBlock(proposalData?.startBlock ?? undefined)\n\n  // only show voting if user has > 0 votes at proposal start block and proposal is active,\n  const showVotingButtons =\n    availableVotes &&\n    JSBI.greaterThan(availableVotes.raw, JSBI.BigInt(0)) &&\n    proposalData &&\n    proposalData.status === 'active'\n\n  const uniBalance: TokenAmount | undefined = useTokenBalance(account ?? undefined, chainId ? UNI[chainId] : undefined)\n  const userDelegatee: string | undefined = useUserDelegatee()\n\n  // in blurb link to home page if they are able to unlock\n  const showLinkForUnlock = Boolean(\n    uniBalance && JSBI.notEqual(uniBalance.raw, JSBI.BigInt(0)) && userDelegatee === ZERO_ADDRESS\n  )\n\n  // show links in propsoal details if content is an address\n  // if content is contract with common name, replace address with common name\n  const linkIfAddress = (content: string) => {\n    if (isAddress(content) && chainId) {\n      const commonName = COMMON_CONTRACT_NAMES[content] ?? content\n      return <ExternalLink href={getEtherscanLink(chainId, content, 'address')}>{commonName}</ExternalLink>\n    }\n    return <span>{content}</span>\n  }\n\n  return (\n    <PageWrapper gap=\"lg\" justify=\"center\">\n      <VoteModal isOpen={showVoteModal} onDismiss={toggleVoteModal} proposalId={proposalData?.id} support={support} />\n      <DelegateModal isOpen={showDelegateModal} onDismiss={toggleDelegateModal} title=\"Unlock Votes\" />\n      <ProposalInfo gap=\"lg\" justify=\"start\">\n        <RowBetween style={{ width: '100%' }}>\n          <ArrowWrapper to=\"/vote\">\n            <ArrowLeft size={20} /> All Proposals\n          </ArrowWrapper>\n          {proposalData && <ProposalStatus status={proposalData?.status ?? ''}>{proposalData?.status}</ProposalStatus>}\n        </RowBetween>\n        <AutoColumn gap=\"10px\" style={{ width: '100%' }}>\n          <TYPE.largeHeader style={{ marginBottom: '.5rem' }}>{proposalData?.title}</TYPE.largeHeader>\n          <RowBetween>\n            <TYPE.main>\n              {endDate && endDate < now\n                ? 'Voting ended ' + (endDate && endDate.toLocaleString(DateTime.DATETIME_FULL))\n                : proposalData\n                ? 'Voting ends approximately ' + (endDate && endDate.toLocaleString(DateTime.DATETIME_FULL))\n                : ''}\n            </TYPE.main>\n          </RowBetween>\n          {proposalData && proposalData.status === 'active' && !showVotingButtons && (\n            <GreyCard>\n              <TYPE.black>\n                Only UNI votes that were self delegated or delegated to another address before block{' '}\n                {proposalData.startBlock} are eligible for voting.{' '}\n                {showLinkForUnlock && (\n                  <span>\n                    <StyledInternalLink to=\"/vote\">Unlock voting</StyledInternalLink> to prepare for the next proposal.\n                  </span>\n                )}\n              </TYPE.black>\n            </GreyCard>\n          )}\n        </AutoColumn>\n        {showVotingButtons ? (\n          <RowFixed style={{ width: '100%', gap: '12px' }}>\n            <ButtonPrimary\n              padding=\"8px\"\n              borderRadius=\"8px\"\n              onClick={() => {\n                setSupport(true)\n                toggleVoteModal()\n              }}\n            >\n              Vote For\n            </ButtonPrimary>\n            <ButtonPrimary\n              padding=\"8px\"\n              borderRadius=\"8px\"\n              onClick={() => {\n                setSupport(false)\n                toggleVoteModal()\n              }}\n            >\n              Vote Against\n            </ButtonPrimary>\n          </RowFixed>\n        ) : (\n          ''\n        )}\n        <CardWrapper>\n          <StyledDataCard>\n            <CardSection>\n              <AutoColumn gap=\"md\">\n                <WrapSmall>\n                  <TYPE.black fontWeight={600}>For</TYPE.black>\n                  <TYPE.black fontWeight={600}>\n                    {' '}\n                    {proposalData?.forCount.toLocaleString(undefined, { maximumFractionDigits: 0 })}\n                  </TYPE.black>\n                </WrapSmall>\n              </AutoColumn>\n              <ProgressWrapper>\n                <Progress status={'for'} percentageString={forPercentage} />\n              </ProgressWrapper>\n            </CardSection>\n          </StyledDataCard>\n          <StyledDataCard>\n            <CardSection>\n              <AutoColumn gap=\"md\">\n                <WrapSmall>\n                  <TYPE.black fontWeight={600}>Against</TYPE.black>\n                  <TYPE.black fontWeight={600}>\n                    {proposalData?.againstCount.toLocaleString(undefined, { maximumFractionDigits: 0 })}\n                  </TYPE.black>\n                </WrapSmall>\n              </AutoColumn>\n              <ProgressWrapper>\n                <Progress status={'against'} percentageString={againstPercentage} />\n              </ProgressWrapper>\n            </CardSection>\n          </StyledDataCard>\n        </CardWrapper>\n        <AutoColumn gap=\"md\">\n          <TYPE.mediumHeader fontWeight={600}>Details</TYPE.mediumHeader>\n          {proposalData?.details?.map((d, i) => {\n            return (\n              <DetailText key={i}>\n                {i + 1}: {linkIfAddress(d.target)}.{d.functionSig}(\n                {d.callData.split(',').map((content, i) => {\n                  return (\n                    <span key={i}>\n                      {linkIfAddress(content)}\n                      {d.callData.split(',').length - 1 === i ? '' : ','}\n                    </span>\n                  )\n                })}\n                )\n              </DetailText>\n            )\n          })}\n        </AutoColumn>\n        <AutoColumn gap=\"md\">\n          <TYPE.mediumHeader fontWeight={600}>Description</TYPE.mediumHeader>\n          <MarkDownWrapper>\n            <ReactMarkdown source={proposalData?.description} />\n          </MarkDownWrapper>\n        </AutoColumn>\n        <AutoColumn gap=\"md\">\n          <TYPE.mediumHeader fontWeight={600}>Proposer</TYPE.mediumHeader>\n          <ProposerAddressLink\n            href={proposalData?.proposer && chainId ? getEtherscanLink(chainId, proposalData?.proposer, 'address') : ''}\n          >\n            <ReactMarkdown source={proposalData?.proposer} />\n          </ProposerAddressLink>\n        </AutoColumn>\n      </ProposalInfo>\n    </PageWrapper>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}